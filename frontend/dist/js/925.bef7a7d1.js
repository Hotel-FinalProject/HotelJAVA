"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[925],{2925:function(e,t,o){o.r(t),o.d(t,{default:function(){return ae}});var s=o(6768),i=o(4232),a=o(5130);const l={key:0,class:"details-container"},r={class:"img-container"},n=["src"],c={key:1,class:"no-image-container"},d={class:"hotel-info-card"},h={class:"hotel-top"},v={class:"hotel-name"},k={key:0,class:"favorite-container"},u={key:0,class:"fas fa-heart"},p={key:1,class:"far fa-heart"},m={class:"hotel-info"},w={class:"rating"},g={class:"hotel-info-details"},L={class:"review-container"},R={key:0},f={key:1},C={class:"review-list"},y=["onClick"],I={class:"review-top"},b={class:"review-rating"},M={class:"review-date"},X=["onClick"],E={class:"reviewer"},A={class:"review-content"},F={key:0,class:"review-images"},_=["src"],O={class:"room-list"},$={key:0},H={class:"room-image-container"},T=["src"],D={key:1,class:"no-room-image"},x={class:"room-info"},K={class:"room-name"},U={class:"avg-person"},S={class:"avg-person-text"},W={class:"reservation-info"},P={class:"check-info"},Q=["innerHTML"],V=["innerHTML"],Y={class:"price"},j={class:"reservation-bottom"},B={class:"room-count"},N=["onClick"],q={key:1},z={key:1};function G(e,t,o,G,J,Z){const ee=(0,s.g2)("ReviewModal");return J.hotel?((0,s.uX)(),(0,s.CE)("div",l,[(0,s.Lk)("div",r,[J.hotel.imageUrl?((0,s.uX)(),(0,s.CE)("img",{key:0,src:J.hotel.imageUrl,alt:"Hotel Image"},null,8,n)):((0,s.uX)(),(0,s.CE)("div",c,t[3]||(t[3]=[(0,s.Lk)("p",{class:"no-image-text"},"업체측에서 제공된 이미지가 없습니다",-1)])))]),(0,s.Lk)("div",d,[(0,s.Lk)("div",h,[(0,s.Lk)("div",null,[(0,s.Lk)("div",v,(0,i.v_)(J.hotel.name),1)]),J.isLoggedIn?((0,s.uX)(),(0,s.CE)("div",k,[(0,s.Lk)("div",{class:(0,i.C4)(["heart-button",{favorited:J.isFavorited,unfavorited:!J.isFavorited}]),onClick:t[0]||(t[0]=(...e)=>Z.toggleFavorite&&Z.toggleFavorite(...e))},[J.isFavorited?((0,s.uX)(),(0,s.CE)("i",u)):((0,s.uX)(),(0,s.CE)("i",p))],2)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",m,[(0,s.Lk)("span",w,"⭐ "+(0,i.v_)(J.hotel.rating||"0"),1),(0,s.Lk)("span",null,"("+(0,i.v_)(J.hotel.reviewCount||0)+" 리뷰)",1)]),(0,s.Lk)("div",g,[(0,s.Lk)("p",null,[t[4]||(t[4]=(0,s.Lk)("span",{class:"phone-icon"},"📞",-1)),(0,s.eW)(" 전화번호 : "+(0,i.v_)(J.hotel.hotelnum||"업체측에서 제공된 정보가 없습니다."),1)]),(0,s.Lk)("p",null,[t[5]||(t[5]=(0,s.Lk)("span",{class:"location-icon"},"📍",-1)),(0,s.eW)(" "+(0,i.v_)(J.hotel.address||"업체측에서 제공된 정보가 없습니다.")+" ",1),(0,s.Lk)("button",{class:"copy-button",onClick:t[1]||(t[1]=(...e)=>Z.copyAddressToClipboard&&Z.copyAddressToClipboard(...e))},"주소복사")]),t[6]||(t[6]=(0,s.Lk)("div",{id:"map",style:{width:"500px",height:"400px"}},null,-1))])]),(0,s.Lk)("div",L,[(0,s.Lk)("h3",null,[t[7]||(t[7]=(0,s.eW)(" 리뷰 ")),(0,s.Lk)("button",{class:"toggle-review-btn",onClick:t[2]||(t[2]=(...e)=>Z.toggleReviewMode&&Z.toggleReviewMode(...e))},(0,i.v_)(J.isAllReviewsMode?"일부 보기":"전체 보기"),1)]),J.hotelReviews&&0===J.hotelReviews.length?((0,s.uX)(),(0,s.CE)("div",R,t[8]||(t[8]=[(0,s.Lk)("p",null,"이 호텔에 대한 리뷰가 없습니다.",-1)]))):((0,s.uX)(),(0,s.CE)("div",f,[(0,s.Lk)("div",C,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(J.visibleReviews,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"review-grid",onClick:t=>Z.openReviewModal(e)},[(0,s.Lk)("div",I,[(0,s.Lk)("div",b,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(5,(t=>(0,s.Lk)("span",{key:t,class:(0,i.C4)(["star",t<=e.rating?"filled":"empty"])}," ★ ",2))),64))]),(0,s.Lk)("div",M,[(0,s.eW)((0,i.v_)(Z.reviewFormatDate(e.updateDate||e.writeDate))+" ",1),"신고된 글입니다"!==e.content?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"report-button",onClick:(0,a.D$)((t=>Z.reportReviews(e.reviewId,e.userId)),["stop"])},"신고",8,X)):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",E,(0,i.v_)(e.userName),1),(0,s.Lk)("div",A,(0,i.v_)(e.content),1),e.imageUrl&&e.imageUrl.length>0?((0,s.uX)(),(0,s.CE)("div",F,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.imageUrl,((e,t)=>((0,s.uX)(),(0,s.CE)("img",{key:t,src:e,alt:"Review Image",class:"review-image"},null,8,_)))),128))])):(0,s.Q3)("",!0)],8,y)))),128))])]))]),(0,s.bF)(ee,{isOpen:J.isReviewModalOpen,review:J.selectedReview,onClose:Z.closeReviewModal},null,8,["isOpen","review","onClose"]),(0,s.Lk)("div",O,[t[15]||(t[15]=(0,s.Lk)("h3",null,"객실 정보",-1)),J.hotel.rooms&&J.hotel.rooms.length>0?((0,s.uX)(),(0,s.CE)("div",$,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(J.hotel.rooms,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.roomId,class:"room-card"},[(0,s.Lk)("div",H,[e.roomImageUrl?((0,s.uX)(),(0,s.CE)("img",{key:0,src:e.roomImageUrl,class:"room-img",alt:"Room Image"},null,8,T)):((0,s.uX)(),(0,s.CE)("div",D,t[9]||(t[9]=[(0,s.Lk)("p",{class:"no-room-image-text"},"업체측에서 제공된 이미지가 없습니다",-1)])))]),(0,s.Lk)("div",x,[(0,s.Lk)("h4",K,(0,i.v_)(e.roomType),1),(0,s.Lk)("div",U,[t[10]||(t[10]=(0,s.Lk)("img",{class:"person-icon",src:"https://yaimg.yanolja.com/stay/static/images/v3/icon_my.png"},null,-1)),(0,s.Lk)("span",S,"기준인원 "+(0,i.v_)(e.roomOccupancy)+"인",1)]),(0,s.Lk)("div",W,[t[13]||(t[13]=(0,s.Lk)("h5",{class:"reservation-text"},"숙박",-1)),(0,s.Lk)("div",P,[t[11]||(t[11]=(0,s.eW)(" 체크인 ")),(0,s.Lk)("span",{innerHTML:Z.formattedCheckIn},null,8,Q),t[12]||(t[12]=(0,s.eW)(" ~ 체크아웃 ")),(0,s.Lk)("span",{innerHTML:Z.formattedCheckOut},null,8,V)]),(0,s.Lk)("h2",Y,(0,i.v_)(e.roomPrice?`${e.roomPrice.toLocaleString()}원`:"가격 정보 없음"),1),(0,s.Lk)("div",j,[(0,s.Lk)("div",B,"남은 객실 "+(0,i.v_)(e.roomCount)+"개",1),(0,s.Lk)("button",{onClick:t=>Z.move(e),class:"reservation_btn"},"예약 및 상세보기",8,N)])])])])))),128))])):((0,s.uX)(),(0,s.CE)("div",q,t[14]||(t[14]=[(0,s.Lk)("div",{class:"room-card"},[(0,s.Lk)("div",{class:"no-room-info-container"},[(0,s.Lk)("p",{class:"no-room-info-text"},"업체측에서 제공된 객실 정보가 없습니다.")])],-1)])))])])):((0,s.uX)(),(0,s.CE)("div",z,t[16]||(t[16]=[(0,s.Lk)("p",null,"호텔 정보를 불러오는 중입니다...",-1)])))}o(4114);var J=o(4373),Z=o(412),ee=o(6698),te=o(7367),oe={name:"HotelDetails",components:{ReviewModal:te.A},data(){return{hotel:null,hotelReviews:[],visibleReviews:[],visibleReviewCount:3,isFavorited:!1,isLoggedIn:!1,isReviewModalOpen:!1,isAllReviewsMode:!1,selectedReview:null}},mounted(){this.fetchFavoriteStatus()},async created(){const e=(0,ee.n)();e.checkLoginStatus(),this.isLoggedIn=e.LoggedIn,this.token=e.accessToken,await this.fetchHotelDetails(),this.hotel&&this.hotel.mapX&&this.hotel.mapY&&this.loadKakaoMap()},beforeUnmount(){const e=document.querySelector("script[src*='//dapi.kakao.com/v2/maps/sdk.js']");e&&(e.remove(),delete window.kakao)},watch:{hotel(e){e&&e.mapX&&e.mapY&&this.loadKakaoMap()}},computed:{formattedCheckIn(){return this.hotel.checkIn?this.hotel.checkIn.replace(/<br\s*\/?>/gi,"<br>"):"정보없음"},formattedCheckOut(){return this.hotel.checkOut?this.hotel.checkOut.replace(/<br\s*\/?>/gi,"<br>"):"정보없음"},chunkedVisibleReviews(){const e=[];for(let t=0;t<this.visibleReviews.length;t+=3)e.push(this.visibleReviews.slice(t,t+3));return e}},methods:{async fetchHotelDetails(){const e=this.$route.params.id;try{const t=await J.A.get(`/api/hotels/${e}`);this.hotel=t.data,console.log(this.hotel),await this.fetchHotelReviews(e)}catch(t){console.error("호텔 상세 정보를 가져오는 중 오류 발생:",t)}},move(e){this.$router.push({params:{roomId:e.roomId},name:"HotelRoom",state:{hotelName:this.hotel.name,roomName:e.roomType,roomPrice:e.roomPrice,checkIn:this.hotel.checkIn,checkOut:this.hotel.checkOut,roomId:e.roomId}})},copyAddressToClipboard(){this.hotel&&this.hotel.address&&navigator.clipboard.writeText(this.hotel.address).then((()=>{alert("주소가 복사되었습니다.")})).catch((e=>{console.error("주소 복사 중 오류가 발생했습니다.",e)}))},loadKakaoMap(){if("undefined"===typeof kakao){const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?appkey=8e08ae88fe732a2c4cfd5d4e46ee2fe5&autoload=false",e.onload=this.initMap,document.head.appendChild(e)}else this.initMap()},initMap(){kakao.maps.load((()=>{const e=document.getElementById("map"),t={center:new kakao.maps.LatLng(this.hotel.mapY||"좌표❌",this.hotel.mapX||"좌표❌"),level:3},o=new kakao.maps.Map(e,t),s=new kakao.maps.LatLng(this.hotel.mapY||"좌표❌",this.hotel.mapX||"좌표❌"),i=new kakao.maps.Marker({position:s});i.setMap(o)}))},async fetchFavoriteStatus(){const e=this.token,t=this.$route.params.id;if(this.isLoggedIn)try{const o=await J.A.get(`/api/auth/favorites/status/${t}`,{headers:{Authorization:`Bearer ${e}`}});this.isFavorited=o.data}catch(o){console.error("찜 상태 불러오기 실패",o)}},async toggleFavorite(){const e=this.token,t=this.$route.params.id;if(!this.isLoggedIn)return void alert("로그인 후 즐겨찾기를 추가할 수 있습니다.");const o=this.isFavorited?`/api/auth/favorites/cancel/${t}`:`/api/auth/favorites/${t}`;try{await J.A.post(o,{},{headers:{Authorization:`Bearer ${e}`}}),this.isFavorited=!this.isFavorited}catch(s){console.error("찜 상태 변경 실패",s)}},async fetchHotelReviews(e){try{const t=await(0,Z.TH)(e);this.hotelReviews=t.data,this.updateVisibleReviews()}catch(t){console.error("호텔 리뷰 조회 중 오류 발생:",t)}},updateVisibleReviews(){this.visibleReviews=this.isAllReviewsMode?this.hotelReviews:this.hotelReviews.slice(0,this.visibleReviewCount)},toggleReviewMode(){this.isAllReviewsMode=!this.isAllReviewsMode,this.updateVisibleReviews()},reviewFormatDate(e){const t={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(e).toLocaleDateString("ko-KR",t)},expandReviews(){const e=this.visibleReviewCount+3;this.visibleReviewCount=e,this.visibleReviews=this.hotelReviews.slice(0,e)},async reportReviews(e,t){const o=(0,ee.n)(),s=sessionStorage.getItem("token");if(!this.isLoggedIn)return alert("로그인이 필요합니다"),void this.$router.push("/login");if(!e)return alert("신고 정보를 확인할 수 없습니다."),void console.error("Missing userId or reviewId");console.log("리뷰 id : ",e),console.log("리뷰 유저 : ",t);const i={reporterId:o.userId,reportedId:t,reviewId:e};try{const e=await(0,Z.DQ)(i,s);e.data&&(alert("신고되었습니다."),console.log(e.data))}catch(a){alert("신고 중 오류가 발생했습니다."),console.error("Axios request error:",a.response||a.message)}},openReviewModal(e){this.selectedReview=e,this.isReviewModalOpen=!0},closeReviewModal(){this.isReviewModalOpen=!1,this.selectedReview=null},openAllReviewsModal(){this.isAllReviewsModalOpen=!0},closeAllReviewsModal(){this.isAllReviewsModalOpen=!1}}},se=o(1241);const ie=(0,se.A)(oe,[["render",G],["__scopeId","data-v-4f3b1882"]]);var ae=ie}}]);
//# sourceMappingURL=925.bef7a7d1.js.map