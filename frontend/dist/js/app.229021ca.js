(function(){"use strict";var e={412:function(e,t,a){a.d(t,{Ad:function(){return l},DQ:function(){return I},E7:function(){return c},E_:function(){return n},Gm:function(){return b},J:function(){return m},KW:function(){return h},Lx:function(){return i},PY:function(){return p},R1:function(){return C},Ro:function(){return r},T2:function(){return g},TH:function(){return y},UR:function(){return v},Wr:function(){return w},bx:function(){return f},od:function(){return k},ug:function(){return d},uj:function(){return L},vb:function(){return u}});var o=a(4373);const s=o.A.create({baseURL:"http://43.200.45.122/api",headers:{"Content-Type":"application/json"}});function n(e,t){return s.post("/users/signup",e,{headers:{verificationToken:`Bearer ${t}`}})}function i(e){return s.post("/users/login",e)}function r(e){return s.get("/users/check-email",{params:{email:e}})}function l(e){return s.post("/users/find-id",{name:e})}function c(e,t){return s.post("/users/send-verification-email",{email:e,mode:t})}function u(e){return s.get("/users/verify-email",{params:{token:e}})}function d(e){return s.get("/auth/users/me",{headers:{Authorization:`Bearer ${e}`}})}const h=(e,t)=>s.post("/users/reset-password",{email:e,token:t});function m(e,t){return s.put("/auth/users/update",e,{headers:{Authorization:`Bearer ${t}`}})}function p(e,t){return s.post("/auth/users/verify-password",{password:e},{headers:{Authorization:`Bearer ${t}`}})}function v(e,t,a){return s.post("/auth/users/reset-password",{email:e,newPassword:t,token:a})}function k(e){return s.delete("/auth/users/delete",{headers:{Authorization:`Bearer ${e}`}})}function g(e){return s.get("/auth/reservationInfo",{headers:{Authorization:`Bearer ${e}`}})}function f(e,t){for(let[a,o]of e.entries())console.log(`${a}: ${o}`);return s.post("/auth/reviews",e,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"multipart/form-data"}})}function y(e){return s.get(`/reviews/hotel/${e}`)}function L(e,t){return s.get(`/auth/reviews/user/${e}`,{headers:{Authorization:`Bearer ${t}`}})}function b(e,t,a){return s.put(`/auth/reviews/${e}`,t,{headers:{Authorization:`Bearer ${a}`}})}function w(e,t){return s.delete(`/auth/reviews/${e}`,{headers:{Authorization:`Bearer ${t}`}})}function I(e,t){return s.post("/auth/reports",e,{headers:{Authorization:`Bearer ${t}`}})}function C(e){return s.get("/auth/favorites/favoriteInfo",{headers:{Authorization:`Bearer ${e}`}})}},8429:function(e,t,a){var o=a(5130),s=a(6768);function n(e,t,a,o,n,i){const r=(0,s.g2)("NavBar"),l=(0,s.g2)("DefaultLayout");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(r),(0,s.bF)(l)],64)}const i={class:"layout"},r={class:"main-content"};function l(e,t,a,o,n,l){const c=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.Lk)("main",r,[(0,s.bF)(c)])])}var c={name:"DefaultLayout"},u=a(1241);const d=(0,u.A)(c,[["render",l],["__scopeId","data-v-48edadd4"]]);var h=d,m=a(4232);const p={class:"navbar"},v={class:"navbar_logo"},k={class:"navbar_items"},g={key:0,class:"navbar_item"},f={key:1,class:"navbar_item"};function y(e,t,a,o,n,i){const r=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("nav",p,[(0,s.Lk)("div",v,[(0,s.Lk)("span",{class:"brand_name",onClick:t[0]||(t[0]=e=>i.to_home())},"HotelJava")]),(0,s.Lk)("div",k,[o.isLoggedIn?((0,s.uX)(),(0,s.CE)("ul",f,[(0,s.Lk)("li",null,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.logout&&o.logout(...e)),class:"logout_btn"},"로그아웃")]),(0,s.Lk)("li",null,[(0,s.Lk)("span",{class:"my_page_btn",onClick:t[2]||(t[2]=(...e)=>i.to_my_page&&i.to_my_page(...e)),onMouseover:t[3]||(t[3]=e=>o.hover=!0),onMouseleave:t[4]||(t[4]=e=>o.hover=!1)},(0,m.v_)(o.hover?o.pageLabel:o.userName),33)])])):((0,s.uX)(),(0,s.CE)("ul",g,[(0,s.Lk)("li",null,[(0,s.bF)(r,{to:"/login"},{default:(0,s.k6)((()=>t[5]||(t[5]=[(0,s.Lk)("span",{class:"login_btn"},"로그인",-1)]))),_:1})]),(0,s.Lk)("li",null,[(0,s.bF)(r,{to:"/register"},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.Lk)("span",{class:"signup_btn"},"회원가입",-1)]))),_:1})])]))])])}a(4114);var L=a(6698),b=a(144),w=a(5068),I={name:"theNavbar",setup(){const e=(0,L.n)(),t=(0,s.EW)((()=>e.LoggedIn)),a=(0,s.EW)((()=>e.userName||"사용자")),o=(0,s.EW)((()=>{const e=sessionStorage.getItem("token");if(e)try{const t=(0,w.s)(e);return t.role}catch(t){return console.error("토큰 디코딩 중 오류 발생: ",t),null}return null})),n=(0,s.EW)((()=>"ROLE_ADMIN"===o.value||"ROLE_HOTEL_MANAGER"===o.value?"관리자 페이지":"마이페이지")),i=(0,b.KR)(!1),r=()=>{e.logout()};return{isLoggedIn:t,userName:a,hover:i,logout:r,pageLabel:n}},methods:{to_my_page(){this.$router.push("/my_page")},to_home(){this.$router.push("/")}}};const C=(0,u.A)(I,[["render",y],["__scopeId","data-v-121ac3b0"]]);var R=C,E={name:"App",components:{DefaultLayout:h,NavBar:R}};const _=(0,u.A)(E,[["render",n]]);var A=_,S=a(5234),X=a(7360),P=a(1999),U=a(3358);const M=(0,S.Ey)();(0,o.Ef)(A).component("vue3-star-ratings",U.A).use(P.Ay,{}).use(M).use(X.A).mount("#app");const D=(0,L.n)();D.checkLoginStatus()},7360:function(e,t,a){a.d(t,{A:function(){return Uo}});var o=a(1387),s=a(6768),n=a(5130),i=a(4232);const r={class:"main-container"},l={class:"search-container"},c={key:0,class:"autocomplete-list"},u=["onClick"],d={class:"autocomplete-hotel-name"},h={class:"hotel-address"},m={key:0,class:"no-results"},p={class:"hotel-title-container"},v={class:"hotel_list_container"},k={class:"hotel_grid"},g=["src"],f={class:"hotel-name"},y={class:"hotel-info"},L={class:"rating"},b={class:"hotel_grid"},w=["src"],I={class:"hotel-name"},C={class:"hotel-info"},R={class:"rating"},E={class:"hotel_grid"},_=["src"],A={class:"hotel-name"},S={class:"hotel-info"},X={class:"rating"};function P(e,t,a,o,P,U){const M=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",r,[(0,s.Lk)("div",l,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>P.searchQuery=e),class:"search-bar",type:"text",placeholder:"여행지를 검색해 보세요!",onClick:t[1]||(t[1]=(...e)=>U.searchHotel&&U.searchHotel(...e))},null,512),[[n.Jo,P.searchQuery]]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>U.searchHotel&&U.searchHotel(...e)),class:"search-button"},"🔍")]),P.searchQuery.length>0?((0,s.uX)(),(0,s.CE)("ul",c,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(P.autocompleteResults,(t=>((0,s.uX)(),(0,s.CE)("li",{key:t.hotelId,onClick:a=>e.goToHotelDetail(t.hotelId),class:"autocomplete-item"},[(0,s.Lk)("span",d,(0,i.v_)(t.name),1),(0,s.Lk)("span",h,(0,i.v_)(t.address||"주소 정보 없음"),1)],8,u)))),128)),P.noResults?((0,s.uX)(),(0,s.CE)("li",m,"연관된 검색어가 없습니다.")):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),(0,s.Lk)("div",p,[t[4]||(t[4]=(0,s.Lk)("h2",{class:"hotel_title"},"오늘의 추천 호텔",-1)),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>U.fetchRandomHotels&&U.fetchRandomHotels(...e)),class:"refresh-button",title:"호텔 정보를 새로고침합니다."}," 🔄 ")]),(0,s.Lk)("div",v,[(0,s.Lk)("div",k,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(P.randomHotels,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.hotelId,class:"hotel-container"},[(0,s.bF)(M,{to:`/hotel-details/${e.hotelId}`},{default:(0,s.k6)((()=>[(0,s.Lk)("img",{src:e.imageUrl||P.defaultImage,class:"img-container",alt:"Hotel Image"},null,8,g)])),_:2},1032,["to"]),(0,s.Lk)("div",f,(0,i.v_)(e.name),1),(0,s.Lk)("div",y,[(0,s.Lk)("span",L,"⭐"+(0,i.v_)(e.rating||0),1),(0,s.Lk)("span",null,"("+(0,i.v_)(e.reviewCount)+")",1)])])))),128))]),t[5]||(t[5]=(0,s.Lk)("h2",{class:"review-title"},"리뷰 Top 10",-1)),(0,s.Lk)("div",b,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(P.topByReviewCount,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.hotelId,class:"hotel-container"},[(0,s.bF)(M,{to:`/hotel-details/${e.hotelId}`},{default:(0,s.k6)((()=>[(0,s.Lk)("img",{src:e.imageUrl||P.defaultImage,class:"img-container",alt:"Hotel Image"},null,8,w)])),_:2},1032,["to"]),(0,s.Lk)("div",I,(0,i.v_)(e.name),1),(0,s.Lk)("div",C,[(0,s.Lk)("span",R,"⭐"+(0,i.v_)(e.rating||0),1),(0,s.Lk)("span",null,"("+(0,i.v_)(e.reviewCount)+")",1)])])))),128))]),t[6]||(t[6]=(0,s.Lk)("h2",{class:"review-title"},"별점 Top 10",-1)),(0,s.Lk)("div",E,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(P.topByRating,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.hotelId,class:"hotel-container"},[(0,s.bF)(M,{to:`/hotel-details/${e.hotelId}`},{default:(0,s.k6)((()=>[(0,s.Lk)("img",{src:e.imageUrl||P.defaultImage,class:"img-container",alt:"Hotel Image"},null,8,_)])),_:2},1032,["to"]),(0,s.Lk)("div",A,(0,i.v_)(e.name),1),(0,s.Lk)("div",S,[(0,s.Lk)("span",X,"⭐"+(0,i.v_)(e.rating||0),1),(0,s.Lk)("span",null,"("+(0,i.v_)(e.reviewCount)+")",1)])])))),128))])])])}a(4114);var U=a(4373);const M=U.A.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});function D(){return M.get("/hotels/top10")}var $={name:"MainPage",data(){return{searchQuery:"",autocompleteResults:[],randomHotels:[],topByReviewCount:[],topByRating:[],defaultImage:"https://png.pngtree.com/png-vector/20240613/ourlarge/pngtree-modern-hotel-icon-with-palm-trees-black-isolated-on-white-background-vector-png-image_7010310.png",noResults:!1}},created(){this.fetchRandomHotels(),this.fetchTopHotelList()},methods:{async fetchRandomHotels(){try{const e=await U.A.get("/api/hotels/random");this.randomHotels=e.data}catch(e){console.error("랜덤 호텔 데이터를 가져오는 중 오류 발생:",e)}},fetchAutocompleteResults(){if(this.autocompleteResults=[],this.searchQuery.length>0){const e=this.searchQuery.replace(/\s+/g,"");U.A.get(`/api/hotels/search?query=${e}`).then((e=>{this.autocompleteResults=e.data,this.noResults=0===this.autocompleteResults.length})).catch((e=>{console.error("자동 완성 결과를 가져오는 중 오류 발생:",e),this.autocompleteResults=[],this.noResults=!0}))}else this.autocompleteResults=[],this.noResults=!1},searchHotel(){this.$router.push({path:"/search-results",query:{query:this.searchQuery}})},goToSearchPage(){this.$router.push({path:"/search-page",query:{query:this.searchQuery}})},async fetchTopHotelList(){try{const e=await D();let t=e.data.topByReviewCount,a=e.data.topByRating;t=t.sort(((e,t)=>t.reviewCount!==e.reviewCount?t.reviewCount-e.reviewCount:e.name.localeCompare(t.name))),a=a.sort(((e,t)=>t.rating!==e.rating?t.rating-e.rating:e.name.localeCompare(t.name))),this.topByReviewCount=t,this.topByRating=a}catch(e){console.error("목록 조회 중 오류 발생: ",e)}}}},T=a(1241);const N=(0,T.A)($,[["render",P],["__scopeId","data-v-232a029c"]]);var V=N;const O={class:"container"},F={class:"form-group"},q={class:"form-group"},H={class:"form-group"},x={class:"form-group email-group"},Q={class:"form-group"};function K(e,t,a,o,i,r){return(0,s.uX)(),(0,s.CE)("div",O,[(0,s.Lk)("form",{onSubmit:t[5]||(t[5]=(0,n.D$)(((...e)=>o.submitForm&&o.submitForm(...e)),["prevent"]))},[t[11]||(t[11]=(0,s.Lk)("h2",null,"회원가입",-1)),(0,s.Lk)("div",F,[t[6]||(t[6]=(0,s.Lk)("label",{for:"name"},"이름",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>o.name=e)},null,512),[[n.Jo,o.name]])]),(0,s.Lk)("div",q,[t[7]||(t[7]=(0,s.Lk)("label",{for:"password"},"비밀번호",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>o.password=e)},null,512),[[n.Jo,o.password]])]),(0,s.Lk)("div",H,[t[8]||(t[8]=(0,s.Lk)("label",{for:"passwordConfirm"},"비밀번호 확인",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",id:"passwordConfirm","onUpdate:modelValue":t[2]||(t[2]=e=>o.passwordConfirm=e)},null,512),[[n.Jo,o.passwordConfirm]])]),(0,s.Lk)("div",x,[(0,s.Lk)("div",null,[t[9]||(t[9]=(0,s.Lk)("label",{for:"email"},"이메일",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"email","onUpdate:modelValue":t[3]||(t[3]=e=>o.authStore.email=e),disabled:""},null,512),[[n.Jo,o.authStore.email]])])]),(0,s.Lk)("div",Q,[t[10]||(t[10]=(0,s.Lk)("label",{for:"phone"},"전화번호",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"phone","onUpdate:modelValue":t[4]||(t[4]=e=>o.phone=e)},null,512),[[n.Jo,o.phone]])]),t[12]||(t[12]=(0,s.Lk)("button",{type:"submit",class:"signup-button"},"회원가입",-1))],32)])}var B=a(6698),J=a(144),W={name:"SignupForm",setup(){const e=(0,B.n)(),t=(0,o.rd)(),a=(0,J.KR)(""),n=(0,J.KR)(""),i=(0,J.KR)(""),r=(0,J.KR)(""),l=(0,J.KR)("");(0,s.sV)((()=>{e.verificationToken?a.value=e.email:t.push("/verify-email?mode=signup")}));const c=async()=>{if(r.value!==l.value)return void alert("비밀번호가 일치하지 않습니다.");e.verificationToken||(alert("이메일 인증 토큰이 없습니다. 이메일 인증을 다시 진행해주세요."),t.push("/verify-email"));const o={email:a.value,name:n.value,phone:i.value,password:r.value};try{const a=await e.signup(o);a&&201===a.status?(alert("회원가입이 완료되었습니다!"),t.push("/login")):alert(`회원가입 중 오류 발생: ${a.data}`)}catch(s){s.response&&s.response.data?alert(`회원가입 중 오류 발생: ${s.response.data}`):alert("회원가입 중 알 수 없는 오류가 발생했습니다."),console.error(`회원가입 중 오류 발생: ${s}`)}};return{email:a,name:n,phone:i,password:r,passwordConfirm:l,submitForm:c,authStore:e}}};const j=(0,T.A)(W,[["render",K],["__scopeId","data-v-13e978e4"]]);var z=j;const G={class:"container"},Y={class:"login-form"},Z={class:"input-group"},ee={class:"input-group"},te={class:"top-actions"},ae={class:"social-login"};function oe(e,t,a,o,i,r){const l=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",G,[(0,s.Lk)("div",Y,[t[10]||(t[10]=(0,s.Lk)("h2",{class:"title"},"로그인",-1)),(0,s.Lk)("form",{onSubmit:t[2]||(t[2]=(0,n.D$)(((...e)=>r.submitForm&&r.submitForm(...e)),["prevent"]))},[(0,s.Lk)("div",Z,[t[5]||(t[5]=(0,s.Lk)("label",{for:"email"},"Email",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>i.email=e)},null,512),[[n.Jo,i.email]])]),(0,s.Lk)("div",ee,[t[6]||(t[6]=(0,s.Lk)("label",{for:"password"},"비밀번호",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",id:"passwd","onUpdate:modelValue":t[1]||(t[1]=e=>i.passwd=e)},null,512),[[n.Jo,i.passwd]])]),(0,s.Lk)("div",te,[(0,s.bF)(l,{to:"/find-my-id"},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.Lk)("span",{class:"find-id-btn"},"아이디 찾기",-1)]))),_:1}),(0,s.bF)(l,{to:"/reset-password"},{default:(0,s.k6)((()=>t[8]||(t[8]=[(0,s.Lk)("span",{class:"find-id-btn"},"비밀번호 초기화",-1)]))),_:1}),t[9]||(t[9]=(0,s.Lk)("button",{type:"submit",class:"login-button"},"로그인",-1))])],32),t[11]||(t[11]=(0,s.Lk)("div",{class:"divider"},[(0,s.Lk)("span",null,"SNS LOGIN")],-1)),(0,s.Lk)("div",ae,[(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>r.googleLogin&&r.googleLogin(...e)),class:"social-button google"},"G"),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>r.naverLogin&&r.naverLogin(...e)),class:"social-button naver"},"N")])])])}var se={name:"LoginForm",data(){return{email:"",passwd:""}},methods:{async googleLogin(){window.location.href="http://43.200.45.122//oauth2/authorization/google"},async naverLogin(){window.location.href="http://43.200.45.122//oauth2/authorization/naver"},async submitForm(){const e={email:this.email,passwd:this.passwd};try{const t=(0,B.n)();await t.login(e),alert("로그인 성공!"),Uo.push({path:"/"})}catch(t){console.error("로그인 중 오류 발생: ",t),alert("로그인 실패. 이메일과 비밀번호를 확인하세요.")}}}};const ne=(0,T.A)(se,[["render",oe],["__scopeId","data-v-b732dc3e"]]);var ie=ne;function re(e,t,a,o,n,i){return(0,s.uX)(),(0,s.CE)("div",null,"로그인 처리 중입니다...")}var le={name:"OAuthRedirectHandler",setup(){const e=(0,B.n)(),t=(0,o.rd)(),a=(0,o.lq)(),s=async()=>{const o=a.query.token;if(o){e.setAccessToken(o);try{const a=await U.A.get("/api/auth/users/me",{headers:{Authorization:`Bearer ${o}`}});if(a&&200===a.status){const s=a.data;e.currentUser=s.email,e.userId=s.userId,e.userName=s.name,e.phone=s.phone,e.LoggedIn=!0,localStorage.setItem("userInfo",JSON.stringify({userName:s.name,userId:s.userId,email:s.email,phone:s.phone})),sessionStorage.setItem("token",o),t.push({path:"/"})}else console.error("사용자 정보를 가져오는 데 실패했습니다."),alert("사용자 정보를 가져오는 데 실패했습니다. 다시 시도해 주세요."),t.push({path:"/login"})}catch(s){console.error("사용자 정보 요청 실패:",s),alert("사용자 정보 요청에 실패했습니다. 다시 시도해 주세요."),t.push({path:"/login"})}}else alert("오류가 발생했습니다. 로그인 실패."),t.push({path:"/login"})};return s(),{}}};const ce=(0,T.A)(le,[["render",re]]);var ue=ce;const de={class:"verification-container"},he={key:0},me=["disabled"],pe={key:1},ve={key:2};function ke(e,t,a,o,r,l){return(0,s.uX)(),(0,s.CE)("div",de,[t[7]||(t[7]=(0,s.Lk)("h2",null,"이메일 인증",-1)),e.verificationToken?o.isVerified?((0,s.uX)(),(0,s.CE)("div",pe,[t[5]||(t[5]=(0,s.Lk)("p",null,"이메일 인증이 완료되었습니다.",-1)),"signup"===o.mode?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[3]||(t[3]=(...e)=>o.proceedToSignup&&o.proceedToSignup(...e))}," 회원가입 페이지로 이동 ")):"resetPassword"===o.mode?((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t[4]||(t[4]=(...e)=>o.proceedToResetPassword&&o.proceedToResetPassword(...e))}," 비밀번호 재설정 페이지로 이동 ")):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",ve,t[6]||(t[6]=[(0,s.Lk)("p",null,"이메일 인증 중입니다...",-1)]))):((0,s.uX)(),(0,s.CE)("div",he,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.email=e),placeholder:"이메일을 입력하세요",onBlur:t[1]||(t[1]=e=>"signup"===o.mode?o.checkEmailAvailability():null)},null,544),[[n.Jo,o.email]]),"signup"===o.mode&&o.emailMessage?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,i.C4)({error:!o.isEmailAvailable,success:o.isEmailAvailable})},(0,i.v_)(o.emailMessage),3)):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>o.sendVerificationEmail&&o.sendVerificationEmail(...e)),disabled:"signup"===o.mode&&!o.isEmailAvailable}," 인증 요청 ",8,me)]))])}var ge={name:"EmailVerificationPage",setup(){const e=(0,o.lq)(),t=(0,o.rd)(),a=(0,B.n)(),n=(0,J.KR)(e.query.mode),i=(0,J.KR)(e.query.token),r=(0,J.KR)(""),l=(0,J.KR)(!1),c=(0,J.KR)(""),u=(0,J.KR)(!1);console.log("초기 verificationToken:",i.value),console.log("초기 mode:",n.value);const d=async()=>{if(!r.value)return c.value="이메일을 입력해주세요.",void(u.value=!1);try{await a.checkEmailAvailability(r.value),c.value=a.emailMessage,u.value=a.isEmailAvailable}catch(e){console.error("이메일 중복 확인 실패:",e),c.value="이메일 중복 확인 중 오류가 발생했습니다.",u.value=!1}},h=async()=>{if(r.value)if("signup"!==n.value||u.value)try{await a.sendVerificationEmail(r.value,n.value),alert("인증 이메일이 발송되었습니다. 메일을 확인해주세요.")}catch(e){console.error("이메일 발송 실패:",e),alert("이메일 발송 중 오류가 발생했습니다.")}else alert("사용할 수 없는 이메일입니다. 다른 이메일을 사용해주세요.");else alert("이메일을 입력해주세요.")};(0,s.wB)(i,(async e=>{if(e)try{console.log("인증 요청을 보낼 토큰:",e);const o=await a.verifyEmailToken(e);console.log("스프링에서 받은 이메일 인증 결과:",o.data),o.data&&o.data.success?(l.value=!0,a.verificationToken=e,r.value=o.data.email,a.email=o.data.email,"signup"===n.value?t.push({path:"/register"}):"resetPassword"===n.value?t.push({path:"/reset-password"}):"editPassword"===n.value&&(localStorage.setItem("verifiedEmail",r.value),localStorage.setItem("verificationToken",e),alert("이메일 인증이 완료되었습니다. 비밀번호 변경을 진행해주세요."),window.close())):(console.error("응답 데이터에서 success 값을 찾을 수 없습니다.",o),alert("이메일 인증에 실패했습니다. 토큰이 만료되었거나 유효하지 않습니다. 다시 인증을 요청하세요."),t.push({path:"/verify-email",query:{mode:n.value}}))}catch(o){console.error("이메일 인증 중 오류 발생: ",o),alert("유효하지 않은 인증 토큰입니다.")}}),{immediate:!0});const m=()=>{t.push({path:"/register"})},p=()=>{t.push({path:"/reset-password"})};return{email:r,emailMessage:c,isEmailAvailable:u,isVerified:l,mode:n,checkEmailAvailability:d,sendVerificationEmail:h,proceedToSignup:m,proceedToResetPassword:p}}};const fe=(0,T.A)(ge,[["render",ke],["__scopeId","data-v-3cfa773a"]]);var ye=fe;const Le={class:"password-reset-container"},be={key:0},we={key:1};function Ie(e,t,a,o,n,i){return(0,s.uX)(),(0,s.CE)("div",Le,[t[3]||(t[3]=(0,s.Lk)("h2",null,"비밀번호 재설정",-1)),o.isEmailSent?((0,s.uX)(),(0,s.CE)("div",we,t[2]||(t[2]=[(0,s.Lk)("p",null,"임시 비밀번호가 이메일로 발송되었습니다. 이메일을 확인하세요.",-1)]))):((0,s.uX)(),(0,s.CE)("div",be,[t[1]||(t[1]=(0,s.Lk)("p",null,"임시 비밀번호를 발급하기 위해 이메일 인증을 완료하세요.",-1)),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>o.sendResetPasswordEmail&&o.sendResetPasswordEmail(...e))},"비밀번호 재설정 요청")]))])}var Ce=a(5234);const Re=(0,Ce.nY)("resetPassword",{state:()=>({email:"",token:""}),actions:{setEmail(e){this.email=e},setToken(e){this.token=e},clearData(){this.email="",this.token=""}}});var Ee=a(412),_e={name:"PasswordResetPage",setup(){const e=Re(),t=(0,B.n)(),a=(0,o.rd)(),n=(0,J.KR)(!1);(0,s.sV)((()=>{t.verificationToken&&t.email?(e.email=t.email,e.token=t.verificationToken):(alert("이메일 인증 정보가 없습니다. 이메일 인증 페이지로 이동합니다."),a.push({path:"/verify-email",query:{mode:"resetPassword"}}))}));const i=async()=>{if(e.email&&e.token)try{const t=await(0,Ee.KW)(e.email,e.token);200===t.status?(n.value=!0,alert("임시 비밀번호가 이메일로 발송되었습니다.")):alert("비밀번호 재설정 요청 중 오류가 발생했습니다.")}catch(t){console.error("비밀번호 재설정 요청 실패:",t),alert("비밀번호 재설정 중 오류가 발생했습니다. 다시 시도해주세요.")}else alert("이메일 인증 정보가 없습니다. 이메일 인증을 먼저 해주세요.")};return{isEmailSent:n,sendResetPasswordEmail:i}}};const Ae=(0,T.A)(_e,[["render",Ie],["__scopeId","data-v-61bf98a0"]]);var Se=Ae;const Xe={class:"mypage-container"},Pe={class:"router-view-container"},Ue={class:"favorite-hotels"},Me={class:"hotel-list"},De=["src"],$e={class:"hotel-name"},Te={key:0};function Ne(e,t,a,o,n,r){const l=(0,s.g2)("SidebarComponent"),c=(0,s.g2)("router-view"),u=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",Xe,[(0,s.bF)(l,{class:"sidebar"}),(0,s.Lk)("div",Pe,[(0,s.bF)(c,null,{default:(0,s.k6)((({Component:e})=>[((0,s.uX)(),(0,s.Wv)((0,s.$y)(e),{"user-name":n.userName,email:n.email,phone:n.phone,reviews:n.reviews,onUpdateReviews:r.handleReviewUpdated,"logged-in-user-id":n.loggedInUserId},null,40,["user-name","email","phone","reviews","onUpdateReviews","logged-in-user-id"]))])),_:1})]),(0,s.Lk)("div",Ue,[t[0]||(t[0]=(0,s.Lk)("h2",null,"찜한 호텔 목록",-1)),(0,s.Lk)("div",Me,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.favoriteHotels,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:"hotel-item",key:t},[(0,s.bF)(u,{to:`/hotel-details/${e.hotelId}`,class:"hotel-link"},{default:(0,s.k6)((()=>[(0,s.Lk)("img",{src:e.hotelImage,alt:"Hotel Image",class:"hotel-image"},null,8,De),(0,s.Lk)("span",$e,(0,i.v_)(e.hotelName),1)])),_:2},1032,["to"])])))),128)),0===n.favoriteHotels.length?((0,s.uX)(),(0,s.CE)("div",Te,"찜한 호텔 목록이 없습니다.")):(0,s.Q3)("",!0)])])])}const Ve={class:"sidebar"};function Oe(e,t){const a=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",Ve,[t[3]||(t[3]=(0,s.Lk)("h2",null,"내 정보",-1)),(0,s.bF)(a,{to:"/my_page","exact-active-class":"active-link"},{default:(0,s.k6)((()=>t[0]||(t[0]=[(0,s.eW)("내 정보 및 리뷰")]))),_:1}),(0,s.bF)(a,{to:"/my_page/reservations","exact-active-class":"active-link"},{default:(0,s.k6)((()=>t[1]||(t[1]=[(0,s.eW)("예약 내역 및 예약 현황")]))),_:1}),(0,s.bF)(a,{to:"/my_page/edit-info","exact-active-class":"active-link"},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)("계정 설정")]))),_:1})])}const Fe={},qe=(0,T.A)(Fe,[["render",Oe],["__scopeId","data-v-7cd401e6"]]);var He=qe,xe={name:"MyPage",components:{SidebarComponent:He},data(){return{userName:"",email:"",phone:"",reviews:[],favoriteHotels:[],loggedInUserId:null,intervalId:null}},mounted(){const e=JSON.parse(localStorage.getItem("userInfo"));e?(this.userName=e.userName||"이름을 추가해주세요.",this.email=e.email||"이메일을 추가해주세요.",this.phone=e.phone||"전화번호를 추가해주세요.",this.loggedInUserId=e.userId,this.fetchUserReviews(),this.fetchUserFavorite(),this.startFetchingReviews()):console.log("로컬 스토리지에 userInfo가 없습니다.")},beforeUnmount(){this.intervalId&&clearInterval(this.intervalId)},methods:{async fetchUserReviews(){try{const e=sessionStorage.getItem("token"),t=await(0,Ee.uj)(this.loggedInUserId,e);this.reviews=t.data}catch(e){console.error("리뷰 데이터를 가져오는 데 실패했습니다:",e)}},startFetchingReviews(){this.intervalId=setInterval(this.fetchUserReviews,3e4)},async fetchUserFavorite(){try{const e=sessionStorage.getItem("token"),t=await(0,Ee.R1)(e);console.log(t.data),this.favoriteHotels=t.data.filter((e=>!1!==e.status))}catch(e){console.error("찜한 호텔 목록 데이터를 가져오는 데 실패했습니다:",e)}},handleReviewUpdated(){this.fetchUserReviews().then((()=>{this.$emit("refresh-reservations")}))}}};const Qe=(0,T.A)(xe,[["render",Ne],["__scopeId","data-v-56d98ed5"]]);var Ke=Qe;const Be={class:"content"},Je={class:"user-info"},We={class:"review-section"},je={class:"review-card-container"},ze={key:0,class:"no-reviews"},Ge={class:"review-top"},Ye=["onClick"],Ze={class:"review-rating"},et={class:"review-content"},tt={class:"image-gallery"},at=["src","onClick"],ot={class:"review-actions"},st=["onClick"],nt=["onClick"],it=["onClick"],rt=["src"];function lt(e,t,a,o,r,l){const c=(0,s.g2)("UserReviewModal"),u=(0,s.g2)("ReviewModal");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Be,[(0,s.Lk)("div",Je,[t[1]||(t[1]=(0,s.Lk)("h2",null,"내 정보",-1)),(0,s.Lk)("p",null,"이름: "+(0,i.v_)(a.userName||"이름을 추가해 주세요."),1),(0,s.Lk)("p",null,"이메일: "+(0,i.v_)(a.email||"이메일을 추가해 주세요."),1),(0,s.Lk)("p",null,"전화번호: "+(0,i.v_)(a.phone||"전화번호를 추가해 주세요."),1)])]),(0,s.Lk)("div",We,[t[2]||(t[2]=(0,s.Lk)("h2",null,"리뷰",-1)),(0,s.Lk)("div",je,[0===a.reviews.length?((0,s.uX)(),(0,s.CE)("div",ze," 작성한 리뷰가 없습니다. ")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.reviews,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"review-card"},[(0,s.Lk)("div",Ge,[(0,s.Lk)("h3",{class:"hotel-name",onClick:t=>l.goToHotel(e.hotelId)},(0,i.v_)(e.hotelName),9,Ye),(0,s.Lk)("div",Ze,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(5,(t=>(0,s.Lk)("span",{key:t,class:(0,i.C4)(["star",{filled:t<=e.rating}])}," ★ ",2))),64))])]),(0,s.Lk)("div",et,(0,i.v_)(e.content),1),(0,s.Lk)("div",tt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.imageUrl,((e,t)=>((0,s.uX)(),(0,s.CE)("img",{src:e,key:t,class:"thumbnail",onClick:t=>l.openLightbox(e)},null,8,at)))),128))]),(0,s.Lk)("div",ot,[(0,s.Lk)("button",{class:"detail-button",onClick:t=>l.openDetailModal(e)}," 리뷰 상세 보기 ",8,st),"신고된 글입니다"!==e.content.trim()?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"edit-button",onClick:t=>l.openEditModal(e)}," 수정하기 ",8,nt)):(0,s.Q3)("",!0),(0,s.Lk)("button",{class:"delete-button",onClick:t=>l.confirmDelete(e.reviewId)}," 삭제하기 ",8,it)])])))),128))]),r.lightboxImage?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"lightbox",onClick:t[0]||(t[0]=(...e)=>l.closeLightbox&&l.closeLightbox(...e))},[(0,s.Lk)("img",{src:r.lightboxImage,alt:"Review Image"},null,8,rt)])):(0,s.Q3)("",!0),(0,s.bo)((0,s.bF)(c,{isEdit:r.isEditMode,initialData:r.selectedReviewData,onSubmit:l.handleReviewSubmit,onClose:l.closeModal},null,8,["isEdit","initialData","onSubmit","onClose"]),[[n.aG,r.isEditModalOpen]]),(0,s.bo)((0,s.bF)(u,{isOpen:r.isDetailModalOpen,review:r.selectedReviewData,onClose:l.closeModal},null,8,["isOpen","review","onClose"]),[[n.aG,r.isDetailModalOpen]])])],64)}const ct={class:"modal-content"},ut={key:0},dt={key:1},ht={class:"rating-container"},mt=["onClick"],pt={key:2,class:"image-upload-container"},vt={class:"image-preview"},kt=["src"],gt=["onClick"],ft={class:"modal-actions"};function yt(e,t,a,o,r,l){return(0,s.uX)(),(0,s.CE)("div",{class:"modal-overlay",onClick:t[4]||(t[4]=(0,n.D$)(((...e)=>l.closeModal&&l.closeModal(...e)),["self"]))},[(0,s.Lk)("div",ct,[a.isEdit?((0,s.uX)(),(0,s.CE)("h2",ut,"리뷰 수정")):((0,s.uX)(),(0,s.CE)("h2",dt,"리뷰 작성")),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.reviewContent=e),placeholder:"리뷰 내용을 입력해주세요",rows:"4"},null,512),[[n.Jo,r.reviewContent]]),(0,s.Lk)("div",ht,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(5,(e=>(0,s.Lk)("span",{key:e,class:(0,i.C4)(["star",{selected:e<=r.rating}]),onClick:t=>l.setRating(e)}," ★ ",10,mt))),64))]),a.isEdit?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",pt,[(0,s.Lk)("input",{type:"file",accept:"image/*",multiple:"",onChange:t[1]||(t[1]=(...e)=>l.handleImageUpload&&l.handleImageUpload(...e))},null,32)])),(0,s.Lk)("div",vt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.uploadedImages,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"image-preview-item"},[(0,s.Lk)("img",{src:e.url,alt:"Preview"},null,8,kt),a.isEdit?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:e=>l.removeImage(t)},"삭제",8,gt))])))),128))]),(0,s.Lk)("div",ft,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.submitReview&&l.submitReview(...e))},(0,i.v_)(a.isEdit?"수정":"작성"),1),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>l.closeModal&&l.closeModal(...e))},"취소")])])])}var Lt={props:{isEdit:Boolean,initialData:Object},data(){return{reviewContent:"",rating:0,uploadedImages:[]}},methods:{setRating(e){this.rating=e},handleImageUpload(e){if(this.isEdit)return;const t=Array.from(e.target.files);t.length?t.forEach((e=>{const t=new FileReader;t.onload=t=>{t.target&&t.target.result?this.uploadedImages.push({file:e,url:t.target.result}):console.error("이미지 로딩 실패:",t)},t.readAsDataURL(e)})):console.error("이미지 파일이 선택되지 않았습니다.")},removeImage(e){this.uploadedImages.splice(e,1)},submitReview(){if(!this.reviewContent||this.rating<=0)return void alert("리뷰 내용을 입력하고 별점을 선택하세요.");if(!this.uploadedImages||!Array.isArray(this.uploadedImages))return alert("이미지 데이터가 올바르지 않습니다."),void console.error("uploadedImages is not an array:",this.uploadedImages);const e=new FormData;e.append("content",this.reviewContent),e.append("rating",this.rating),this.uploadedImages.forEach(((t,a)=>{t.file?e.append("images",t.file):console.warn(`유효하지 않은 이미지 데이터 (index: ${a}):`,t)})),console.log("리뷰 제출 데이터:",{content:this.reviewContent,rating:this.rating,images:this.uploadedImages}),this.$emit("submit",{content:this.reviewContent,rating:this.rating,images:this.uploadedImages})},closeModal(){this.$emit("close")}},watch:{initialData:{immediate:!0,handler(e){e&&(this.reviewContent=e.content||"",this.rating=e.rating||0,this.uploadedImages=e.imageUrl?e.imageUrl.map((e=>({file:null,url:e}))):[])}}}};const bt=(0,T.A)(Lt,[["render",yt],["__scopeId","data-v-cb89d618"]]);var wt=bt,It=a(7367),Ct={props:{userName:{type:String,required:!0},email:{type:String,required:!0},phone:{type:String,required:!0},reviews:Array,loggedInUserId:Number},components:{UserReviewModal:wt,ReviewModal:It.A},data(){return{isEditModalOpen:!1,isDetailModalOpen:!1,isEditMode:!1,selectedReviewData:null,lightboxImage:null}},methods:{openEditModal(e){this.isEditModalOpen=!0,this.isEditMode=!0,this.selectedReviewData={...e}},openDetailModal(e){this.isDetailModalOpen=!0,this.selectedReviewData={...e}},closeModal(){this.isEditModalOpen=!1,this.isDetailModalOpen=!1,this.isEditMode=!1,this.selectedReviewData=null},async handleReviewSubmit(e){try{const t=sessionStorage.getItem("token");this.isEditMode&&this.selectedReviewData&&(await(0,Ee.Gm)(this.selectedReviewData.reviewId,e,t),alert("리뷰가 수정되었습니다.")),this.closeModal(),this.$emit("update-reviews")}catch(t){console.error("리뷰 처리 중 오류 발생:",t),alert("리뷰 처리 중 오류가 발생했습니다.")}},async confirmDelete(e){if(confirm("정말로 이 리뷰를 삭제하시겠습니까?"))try{const t=sessionStorage.getItem("token");await(0,Ee.Wr)(e,t),alert("리뷰가 삭제되었습니다."),this.$emit("update-reviews")}catch(t){console.error("리뷰 삭제 중 오류 발생:",t),alert("리뷰 삭제 중 오류가 발생했습니다.")}},openLightbox(e){this.lightboxImage=e},closeLightbox(){this.lightboxImage=null},goToHotel(e){this.$router.push(`/hotel-details/${e}`)}}};const Rt=(0,T.A)(Ct,[["render",lt],["__scopeId","data-v-2b00caef"]]);var Et=Rt;const _t={class:"reservation-container"},At={class:"reservation-card-container"},St={key:0},Xt={key:1},Pt={class:"reservation-info"},Ut=["onClick"],Mt={class:"request"},Dt=["onClick"],$t={key:2},Tt={class:"reservation-card-container"},Nt={key:0},Vt={class:"reservation-info"},Ot=["onClick"],Ft={class:"request"},qt=["onClick"],Ht={key:1};function xt(e,t,a,o,n,r){const l=(0,s.g2)("ReviewModal");return(0,s.uX)(),(0,s.CE)("div",_t,[t[2]||(t[2]=(0,s.Lk)("h2",null,"현재 예약",-1)),(0,s.Lk)("div",At,[o.loading||0!==o.visibleUpcomingReservations.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",St," 예약 내역이 없습니다. ")),o.loading?((0,s.uX)(),(0,s.CE)("div",Xt,"예약 목록을 불러오는 중입니다...")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.visibleUpcomingReservations,((t,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:"reservation-card"},[(0,s.Lk)("div",Pt,[(0,s.Lk)("h3",{class:"hotel-name",onClick:a=>e.goToHotel(t.hotelId)},(0,i.v_)(t.hotelName),9,Ut),(0,s.Lk)("p",null,"객실 이름: "+(0,i.v_)(t.roomName),1),(0,s.Lk)("p",null,"체크인: "+(0,i.v_)(t.checkIn),1),(0,s.Lk)("p",null,"체크아웃: "+(0,i.v_)(t.checkOut),1),(0,s.Lk)("p",null,"투숙 인원: "+(0,i.v_)(t.guestNum),1),(0,s.Lk)("p",Mt,"요청 사항: "+(0,i.v_)(t.request),1),(0,s.Lk)("p",null,"예약 상태: "+(0,i.v_)(t.status),1),o.canCancel(t.checkIn)?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:a=>e.cancelReservation(t),class:"cancel-button"}," 결제 취소 ",8,Dt)):(0,s.Q3)("",!0)])])))),128)),e.upcomingReservations>o.visibleUpcomingReservations.length?((0,s.uX)(),(0,s.CE)("div",$t,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.loadMoreUpcomingReservations&&e.loadMoreUpcomingReservations(...t))},"더 보기")])):(0,s.Q3)("",!0)]),t[3]||(t[3]=(0,s.Lk)("h2",null,"예약 기록",-1)),(0,s.Lk)("div",Tt,[o.loading||0!==o.visiblePastReservations.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Nt," 지난 예약 내역이 없습니다. ")),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.visiblePastReservations,((t,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:"reservation-card"},[(0,s.Lk)("div",Vt,[(0,s.Lk)("h3",{class:"hotel-name",onClick:a=>e.goToHotel(t.hotelId)},(0,i.v_)(t.hotelName),9,Ot),(0,s.Lk)("p",null,"객실 이름: "+(0,i.v_)(t.roomName),1),(0,s.Lk)("p",null,"체크인: "+(0,i.v_)(t.checkIn),1),(0,s.Lk)("p",null,"체크아웃: "+(0,i.v_)(t.checkOut),1),(0,s.Lk)("p",null,"투숙 인원: "+(0,i.v_)(t.guestNum),1),(0,s.Lk)("p",Ft,"요청 사항: "+(0,i.v_)(t.request),1),(0,s.Lk)("p",null,"예약 상태: "+(0,i.v_)(t.status),1),o.canWriteReview(t.checkOut)&&!o.hasReview(t.reservationId)?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:e=>o.openReviewModal(t.reservationId)}," 리뷰 작성 ",8,qt)):(0,s.Q3)("",!0)])])))),128)),e.pastReservations>o.visiblePastReservations.length?((0,s.uX)(),(0,s.CE)("div",Ht,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...t)=>e.loadMorePastReservations&&e.loadMorePastReservations(...t))},"더 보기")])):(0,s.Q3)("",!0)]),o.state.isModalOpen?((0,s.uX)(),(0,s.Wv)(l,{key:0,reservationId:o.state.selectedReservationId,onSubmit:o.handleReviewSubmit,onClose:o.closeModal},null,8,["reservationId","onSubmit","onClose"])):(0,s.Q3)("",!0)])}var Qt=a(1576),Kt=a.n(Qt);const Bt=(0,Ce.nY)("reservations",{state:()=>({reservations:[],upcomingReservations:[],pastReservations:[],visibleUpcomingReservations:[],visiblePastReservations:[],loading:!1,pageUpcoming:1,pagePast:1,itemsPerPageUpcoming:6,itemsPerPagePast:6}),actions:{async fetchReservations(){try{this.loading=!0;const e=sessionStorage.getItem("token");if(!e)return alert("로그인이 필요합니다."),void(this.loading=!1);console.log("사용자 토큰:",e);const t=await(0,Ee.T2)(e);console.log("예약 목록 응답:",t.data),this.reservations=t.data.filter((e=>"결제 취소"!==e.paymentStatus)),this.reservations=this.reservations.sort(((e,t)=>{const a=Kt()(e.checkIn),o=Kt()(t.checkIn);return o.diff(a)}));const a=Kt()();this.upcomingReservations=this.reservations.filter((e=>Kt()(e.checkIn).isAfter(a)||Kt()(e.checkIn).isSame(a))),this.pastReservations=this.reservations.filter((e=>Kt()(e.checkIn).isBefore(a))),this.pageUpcoming=1,this.pagePast=1,this.visibleUpcomingReservations=this.upcomingReservations.slice(0,this.itemsPerPageUpcoming),this.visiblePastReservations=this.pastReservations.slice(0,this.itemsPerPagePast),this.loading=!1}catch(e){console.error("예약 목록 불러오기 오류:",e),this.loading=!1,alert("예약 목록을 불러오는 중 오류가 발생했습니다.")}},loadMoreUpcomingReservations(){const e=this.pageUpcoming*this.itemsPerPageUpcoming,t=e+this.itemsPerPageUpcoming,a=this.upcomingReservations.slice(e,t);this.visibleUpcomingReservations=[...this.visibleUpcomingReservations,...a],this.pageUpcoming+=1},loadMorePastReservations(){const e=this.pagePast*this.itemsPerPagePast,t=e+this.itemsPerPagePast,a=this.pastReservations.slice(e,t);this.visiblePastReservations=[...this.visiblePastReservations,...a],this.pagePast+=1}}});var Jt={components:{ReviewModal:wt},props:{reviews:{type:Array,required:!0}},setup(e,{emit:t}){const a=Bt(),o=(0,J.Kh)({isModalOpen:!1,selectedReservationId:null});(0,s.sV)((()=>{a.fetchReservations()}));const n=(0,s.EW)((()=>a.visibleUpcomingReservations||[])),i=(0,s.EW)((()=>a.visiblePastReservations||[])),r=(0,s.EW)((()=>a.loading)),l=e=>{const t=Kt()(),a=Kt()(e);return a.diff(t,"day")>=2},c=e=>{const t=Kt()(),a=Kt()(e),o=t.diff(a,"day");return o>=0&&o<=7},u=t=>e.reviews.some((e=>e.reservationId===t)),d=e=>{e?(o.isModalOpen=!0,o.selectedReservationId=e):alert("예약 정보를 불러오지 못했습니다. 다시 시도해주세요.")},h=async e=>{try{if(!e)return alert("리뷰 데이터가 전달되지 않았습니다."),void console.error("reviewData is undefined:",e);const{content:s,rating:n,images:i}=e;if(!s||!n)return void alert("리뷰 내용과 별점은 필수입니다.");if(!o.selectedReservationId)return void alert("예약 정보가 누락되었습니다. 다시 시도해주세요.");const r=sessionStorage.getItem("token");if(!r)return void alert("로그인이 필요합니다.");const l=new FormData;l.append("content",s),l.append("rating",n),l.append("reservationId",o.selectedReservationId),Array.isArray(i)&&i.length>0&&i.forEach((e=>{e.file?l.append("images",e.file):console.warn("유효하지 않은 이미지 데이터:",e)})),await(0,Ee.bx)(l,r),alert("리뷰가 작성되었습니다."),m(),a.fetchReservations(),t("update-reviews")}catch(s){console.error("리뷰 작성 중 오류 발생:",s),alert("리뷰 작성 중 오류가 발생했습니다.")}},m=()=>{o.isModalOpen=!1,o.selectedReservationId=null};return{visibleUpcomingReservations:n,visiblePastReservations:i,loading:r,canCancel:l,canWriteReview:c,hasReview:u,openReviewModal:d,handleReviewSubmit:h,closeModal:m,state:o}}};const Wt=(0,T.A)(Jt,[["render",xt],["__scopeId","data-v-1a147d11"]]);var jt=Wt;const zt={class:"user-edit-container"},Gt={class:"form-group"},Yt={class:"form-group"},Zt={class:"form-group"},ea={class:"form-group"},ta={key:0,class:"error-text"},aa=["disabled"],oa={class:"form-group"},sa={class:"form-group"},na=["disabled"],ia={key:0,class:"form-group"},ra=["disabled"];function la(e,t,a,o,i,r){return(0,s.uX)(),(0,s.CE)("div",zt,[t[18]||(t[18]=(0,s.Lk)("h2",null,"회원 정보 수정",-1)),(0,s.Lk)("form",{onSubmit:t[5]||(t[5]=(0,n.D$)(((...e)=>r.submitForm&&r.submitForm(...e)),["prevent"]))},[(0,s.Lk)("div",Gt,[t[11]||(t[11]=(0,s.Lk)("label",{for:"userName"},"이름",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"userName","onUpdate:modelValue":t[0]||(t[0]=e=>o.userName=e),placeholder:"이름을 입력하세요"},null,512),[[n.Jo,o.userName]])]),(0,s.Lk)("div",Yt,[t[12]||(t[12]=(0,s.Lk)("label",{for:"email"},"이메일",-1)),(0,s.bo)((0,s.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>o.email=e),placeholder:"이메일을 입력하세요",disabled:""},null,512),[[n.Jo,o.email]]),t[13]||(t[13]=(0,s.Lk)("p",{class:"info-text"},"이메일은 수정할 수 없습니다.",-1))]),(0,s.Lk)("div",Zt,[t[14]||(t[14]=(0,s.Lk)("label",{for:"phone"},"전화번호",-1)),(0,s.bo)((0,s.Lk)("input",{type:"tel",id:"phone","onUpdate:modelValue":t[2]||(t[2]=e=>o.phone=e),placeholder:"전화번호를 입력하세요"},null,512),[[n.Jo,o.phone]])]),(0,s.Lk)("div",ea,[t[15]||(t[15]=(0,s.Lk)("label",{for:"currentPassword"},"현재 비밀번호 확인",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",id:"currentPassword","onUpdate:modelValue":t[3]||(t[3]=e=>i.currentPassword=e),onInput:t[4]||(t[4]=(...e)=>r.checkPassword&&r.checkPassword(...e)),placeholder:"현재 비밀번호를 입력하세요"},null,544),[[n.Jo,i.currentPassword]]),!i.isPasswordValid&&i.currentPassword?((0,s.uX)(),(0,s.CE)("p",ta," 비밀번호가 올바르지 않습니다. ")):(0,s.Q3)("",!0)]),(0,s.Lk)("button",{type:"submit",class:"submit-button",disabled:!i.isPasswordValid}," 수정 완료 ",8,aa)],32),t[19]||(t[19]=(0,s.Lk)("hr",null,null,-1)),t[20]||(t[20]=(0,s.Lk)("h2",null,"비밀번호 변경",-1)),(0,s.Lk)("form",{onSubmit:t[8]||(t[8]=(0,n.D$)(((...e)=>r.sendVerificationCode&&r.sendVerificationCode(...e)),["prevent"]))},[(0,s.Lk)("div",oa,[t[16]||(t[16]=(0,s.Lk)("label",{for:"newPassword"},"새 비밀번호",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",id:"newPassword","onUpdate:modelValue":t[6]||(t[6]=e=>i.newPassword=e),placeholder:"새 비밀번호를 입력하세요"},null,512),[[n.Jo,i.newPassword]])]),(0,s.Lk)("div",sa,[t[17]||(t[17]=(0,s.Lk)("label",{for:"passwordConfirmation"},"비밀번호 확인",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",id:"passwordConfirmation","onUpdate:modelValue":t[7]||(t[7]=e=>i.passwordConfirmation=e),placeholder:"비밀번호를 다시 입력하세요"},null,512),[[n.Jo,i.passwordConfirmation]])]),(0,s.Lk)("button",{type:"submit",class:"send-email-button",disabled:i.newPassword!==i.passwordConfirmation}," 이메일 인증번호 전송 ",8,na)],32),i.isEmailSent?((0,s.uX)(),(0,s.CE)("div",ia,[(0,s.Lk)("button",{type:"button",class:"submit-button",onClick:t[9]||(t[9]=(...e)=>r.changePassword&&r.changePassword(...e)),disabled:!i.isEmailSent}," 비밀번호 변경 ",8,ra)])):(0,s.Q3)("",!0),t[21]||(t[21]=(0,s.Lk)("hr",null,null,-1)),t[22]||(t[22]=(0,s.Lk)("h2",null,"계정 탈퇴",-1)),(0,s.Lk)("button",{class:"delete-account-button",onClick:t[10]||(t[10]=(...e)=>r.confirmDeactivateAccount&&r.confirmDeactivateAccount(...e))}," 계정 탈퇴하기 ")])}var ca={name:"UserEditPage",setup(){const e=(0,B.n)(),t=JSON.parse(localStorage.getItem("userInfo"))||{};return{userName:t.userName||"",email:t.email||"",phone:t.phone||"",authStore:e}},data(){return{currentPassword:"",isPasswordValid:!1,newPassword:"",passwordConfirmation:"",isEmailSent:!1,verificationCode:""}},methods:{async checkPassword(){try{const e=await this.authStore.verifyPassword(this.currentPassword);this.isPasswordValid=200===e.status}catch(e){this.isPasswordValid=!1,console.error("비밀번호 확인 오류:",e)}},async submitForm(){if(this.isPasswordValid)try{await this.authStore.updateUserInfo({userName:this.userName,phone:this.phone}),alert("회원 정보가 성공적으로 수정되었습니다.")}catch(e){console.error("회원 정보 수정 오류:",e),alert("회원 정보 수정 중 오류가 발생했습니다. 다시 시도해 주세요.")}},async sendVerificationCode(){if(this.newPassword===this.passwordConfirmation)try{await this.authStore.sendVerificationEmail(this.email,"editPassword"),this.isEmailSent=!0,alert("이메일로 인증번호가 발송되었습니다.")}catch(e){console.error("인증 이메일 발송 오류:",e),alert("인증 이메일 발송 중 오류가 발생했습니다. 다시 시도해 주세요.")}else alert("새 비밀번호와 확인 비밀번호가 일치하지 않습니다.")},async changePassword(){try{this.isEmailSent?(await this.authStore.changePassword(this.newPassword),alert("비밀번호가 성공적으로 변경되었습니다.")):alert("인증번호가 필요합니다.")}catch(e){console.error("비밀번호 변경 오류:",e),alert("비밀번호 변경 중 오류가 발생했습니다. 다시 시도해 주세요.")}},confirmDeactivateAccount(){const e=confirm("정말로 계정을 탈퇴하시겠습니까? 탈퇴 시 모든 데이터가 삭제됩니다.");e&&this.deactivateAccount()},async deactivateAccount(){try{await this.authStore.deactivateUser(),alert("계정이 성공적으로 탈퇴되었습니다."),this.authStore.logout(),window.location.href="/"}catch(e){console.error("계정 탈퇴 오류:",e),alert("계정 탈퇴 중 오류가 발생했습니다. 다시 시도해 주세요.")}}}};const ua=(0,T.A)(ca,[["render",la],["__scopeId","data-v-49547d10"]]);var da=ua;const ha={class:"menu-container"},ma={class:"main-content"},pa={key:0},va={class:"dashboard-summary"},ka={class:"dashboard-item"},ga={key:0},fa={key:1},ya={class:"dashboard-item"},La={key:0},ba={class:"reservation-table"},wa={key:1},Ia={key:1},Ca={key:0},Ra={class:"room-table"},Ea={class:"description-cell"},_a=["onClick"],Aa=["onClick"],Sa={key:1},Xa={key:2,class:"modal"},Pa={class:"modal-content"},Ua={key:2},Ma={key:0},Da={class:"reservation-table"},$a=["onClick"],Ta={key:1},Na={key:2,class:"modal"},Va={class:"modal-content"},Oa={key:3};function Fa(e,t,a,o,r,l){const c=(0,s.g2)("SidebarLayout");return(0,s.uX)(),(0,s.Wv)(c,{title:"호텔 관리자"},{menu:(0,s.k6)((()=>[(0,s.Lk)("div",ha,[(0,s.Lk)("a",{href:"#",class:(0,i.C4)({active:"Dashboard"===r.currentView}),onClick:t[0]||(t[0]=(0,n.D$)((e=>r.currentView="Dashboard"),["prevent"]))},t[16]||(t[16]=[(0,s.Lk)("span",{class:"icon"},"📋",-1),(0,s.eW)("대시보드 ")]),2),(0,s.Lk)("a",{href:"#",class:(0,i.C4)({active:"RoomManagement"===r.currentView}),onClick:t[1]||(t[1]=(0,n.D$)((e=>r.currentView="RoomManagement"),["prevent"]))},t[17]||(t[17]=[(0,s.Lk)("span",{class:"icon"},"🛏️",-1),(0,s.eW)("객실 관리 ")]),2),(0,s.Lk)("a",{href:"#",class:(0,i.C4)({active:"ReservationManagement"===r.currentView}),onClick:t[2]||(t[2]=(0,n.D$)((e=>r.currentView="ReservationManagement"),["prevent"]))},t[18]||(t[18]=[(0,s.Lk)("span",{class:"icon"},"📅",-1),(0,s.eW)("예약 관리 ")]),2),(0,s.Lk)("a",{href:"#",class:(0,i.C4)({active:"Analytics"===r.currentView}),onClick:t[3]||(t[3]=(0,n.D$)((e=>r.currentView="Analytics"),["prevent"]))},t[19]||(t[19]=[(0,s.Lk)("span",{class:"icon"},"📊",-1),(0,s.eW)("매출 분석 ")]),2)])])),default:(0,s.k6)((()=>[(0,s.Lk)("div",ma,["Dashboard"===r.currentView?((0,s.uX)(),(0,s.CE)("div",pa,[t[27]||(t[27]=(0,s.Lk)("h2",null,"대시보드",-1)),t[28]||(t[28]=(0,s.Lk)("p",null,"호텔의 전체 상태를 한눈에 확인하세요.",-1)),(0,s.Lk)("ul",va,[(0,s.Lk)("li",ka,[t[22]||(t[22]=(0,s.Lk)("h3",null,"🛏️ 객실 관리",-1)),(0,s.Lk)("p",null,"전체 객실 수: "+(0,i.v_)(r.roomSummary?.totalRooms||0)+"개",1),r.roomSummary?.roomTypeCounts&&Object.keys(r.roomSummary.roomTypeCounts).length>0?((0,s.uX)(),(0,s.CE)("div",ga,[t[20]||(t[20]=(0,s.Lk)("p",null,"유형별 객실 수:",-1)),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.roomSummary.roomTypeCounts,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},(0,i.v_)(t)+": "+(0,i.v_)(e)+"개 ",1)))),128))])])):((0,s.uX)(),(0,s.CE)("div",fa,t[21]||(t[21]=[(0,s.Lk)("p",null,"객실 정보가 없습니다.",-1)])))]),(0,s.Lk)("li",ya,[t[25]||(t[25]=(0,s.Lk)("h3",null,"📅 예약 관리",-1)),r.reservationSummary.length>0?((0,s.uX)(),(0,s.CE)("div",La,[(0,s.Lk)("table",ba,[t[23]||(t[23]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{style:{width:"10%"}},"객실 유형"),(0,s.Lk)("th",{style:{width:"7%"}},"예약자 이름"),(0,s.Lk)("th",{style:{width:"10%"}},"휴대폰 번호"),(0,s.Lk)("th",{style:{width:"25%"}},"요청 사항"),(0,s.Lk)("th",{style:{width:"5%"}},"예약 상태")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.reservationSummary,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t},[(0,s.Lk)("td",null,(0,i.v_)(e.roomName),1),(0,s.Lk)("td",null,(0,i.v_)(e.userName),1),(0,s.Lk)("td",null,(0,i.v_)(e.userPhone),1),(0,s.Lk)("td",null,(0,i.v_)(e.request||"없음"),1),(0,s.Lk)("td",null,(0,i.v_)(e.status),1)])))),128))])])])):((0,s.uX)(),(0,s.CE)("div",wa,t[24]||(t[24]=[(0,s.Lk)("p",null,"오늘 예약 정보가 없습니다.",-1)])))]),t[26]||(t[26]=(0,s.Lk)("li",{class:"dashboard-item"},[(0,s.Lk)("h3",null,"📊 매출 분석"),(0,s.Lk)("p",null,"이번 달 매출: 1,200,000원"),(0,s.Lk)("p",null,"예약률: 75%")],-1))])])):(0,s.Q3)("",!0),"RoomManagement"===r.currentView?((0,s.uX)(),(0,s.CE)("div",Ia,[t[37]||(t[37]=(0,s.Lk)("h2",null,"객실 관리",-1)),t[38]||(t[38]=(0,s.Lk)("p",null,"객실 정보를 관리합니다.",-1)),r.rooms.length>0?((0,s.uX)(),(0,s.CE)("div",Ca,[(0,s.Lk)("table",Ra,[t[29]||(t[29]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"객실 유형"),(0,s.Lk)("th",null,"기준 인원"),(0,s.Lk)("th",null,"객실 요금"),(0,s.Lk)("th",null,"객실 설명"),(0,s.Lk)("th",null,"편의 시설"),(0,s.Lk)("th",null,"수정")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.rooms,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.roomId},[(0,s.Lk)("td",null,(0,i.v_)(e.name),1),(0,s.Lk)("td",null,(0,i.v_)(e.occupancy)+"명",1),(0,s.Lk)("td",null,(0,i.v_)(e.price.toLocaleString())+"원",1),(0,s.Lk)("td",Ea,(0,i.v_)(e.description),1),(0,s.Lk)("td",null,[(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.getLimitedAmenities(e),((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},(0,i.v_)(e),1)))),128)),(0,s.Lk)("a",{class:"toggle-button",onClick:t=>l.toggleAmenities(e)},(0,i.v_)(e.amenitiesExpanded?"접기":"더보기"),9,_a)])]),(0,s.Lk)("td",null,[(0,s.Lk)("button",{onClick:t=>l.openEditModal(e)},"수정",8,Aa)])])))),128))])])])):((0,s.uX)(),(0,s.CE)("div",Sa,t[30]||(t[30]=[(0,s.Lk)("p",null,"객실 정보가 없습니다.",-1)]))),r.editingRoom?((0,s.uX)(),(0,s.CE)("div",Xa,[(0,s.Lk)("div",Pa,[t[36]||(t[36]=(0,s.Lk)("h3",null,"객실 정보 수정",-1)),(0,s.Lk)("form",{onSubmit:t[9]||(t[9]=(0,n.D$)(((...e)=>l.saveEdit&&l.saveEdit(...e)),["prevent"]))},[(0,s.Lk)("label",null,[t[31]||(t[31]=(0,s.eW)(" 객실 유형: ")),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>r.editingRoom.name=e)},null,512),[[n.Jo,r.editingRoom.name]])]),(0,s.Lk)("label",null,[t[32]||(t[32]=(0,s.eW)(" 기준 인원: ")),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=e=>r.editingRoom.occupancy=e)},null,512),[[n.Jo,r.editingRoom.occupancy]])]),(0,s.Lk)("label",null,[t[33]||(t[33]=(0,s.eW)(" 객실 요금: ")),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=e=>r.editingRoom.price=e)},null,512),[[n.Jo,r.editingRoom.price]])]),(0,s.Lk)("label",null,[t[34]||(t[34]=(0,s.eW)(" 객실 설명: ")),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>r.editingRoom.description=e)},null,512),[[n.Jo,r.editingRoom.description]])]),t[35]||(t[35]=(0,s.Lk)("button",{type:"submit",class:"save-button"},"저장",-1)),(0,s.Lk)("button",{type:"button",class:"cancel-button",onClick:t[8]||(t[8]=e=>l.cancelEdit("room"))},"취소")],32)])])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),"ReservationManagement"===r.currentView?((0,s.uX)(),(0,s.CE)("div",Ua,[t[48]||(t[48]=(0,s.Lk)("h2",null,"예약 관리",-1)),t[49]||(t[49]=(0,s.Lk)("p",null,"예약 상태를 확인하고 수정할 수 있습니다.",-1)),r.reservations.length>0?((0,s.uX)(),(0,s.CE)("div",Ma,[(0,s.Lk)("table",Da,[t[39]||(t[39]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{style:{width:"10%"}},"객실 이름"),(0,s.Lk)("th",{style:{width:"10%"}},"예약자 이름"),(0,s.Lk)("th",{style:{width:"10%"}},"체크인"),(0,s.Lk)("th",{style:{width:"10%"}},"체크아웃"),(0,s.Lk)("th",{style:{width:"25%"}},"요청 사항"),(0,s.Lk)("th",{style:{width:"10%"}},"상태"),(0,s.Lk)("th",{style:{width:"5%"}},"수정")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.reservations,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.reservationId},[(0,s.Lk)("td",null,(0,i.v_)(e.roomName),1),(0,s.Lk)("td",null,(0,i.v_)(e.userName),1),(0,s.Lk)("td",null,(0,i.v_)(e.checkIn),1),(0,s.Lk)("td",null,(0,i.v_)(e.checkOut),1),(0,s.Lk)("td",null,(0,i.v_)(e.request||"없음"),1),(0,s.Lk)("td",null,(0,i.v_)(e.status),1),(0,s.Lk)("td",null,[(0,s.Lk)("button",{onClick:t=>l.openEditReservation(e)},"수정",8,$a)])])))),128))])])])):((0,s.uX)(),(0,s.CE)("div",Ta,t[40]||(t[40]=[(0,s.Lk)("p",null,"예약 정보가 없습니다.",-1)]))),r.editingReservation?((0,s.uX)(),(0,s.CE)("div",Na,[(0,s.Lk)("div",Va,[t[47]||(t[47]=(0,s.Lk)("h3",null,"예약 정보 수정",-1)),(0,s.Lk)("form",{onSubmit:t[15]||(t[15]=(0,n.D$)(((...e)=>l.updateReservation&&l.updateReservation(...e)),["prevent"]))},[(0,s.Lk)("label",null,[t[42]||(t[42]=(0,s.eW)(" 상태: ")),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[10]||(t[10]=e=>r.editingReservation.status=e)},t[41]||(t[41]=[(0,s.Lk)("option",{value:"예약 완료"},"예약 완료",-1),(0,s.Lk)("option",{value:"취소됨"},"취소됨",-1),(0,s.Lk)("option",{value:"변경 요청"},"변경 요청",-1)]),512),[[n.u1,r.editingReservation.status]])]),(0,s.Lk)("label",null,[t[43]||(t[43]=(0,s.eW)(" 체크인 날짜: ")),(0,s.bo)((0,s.Lk)("input",{type:"date","onUpdate:modelValue":t[11]||(t[11]=e=>r.editingReservation.checkIn=e)},null,512),[[n.Jo,r.editingReservation.checkIn]])]),(0,s.Lk)("label",null,[t[44]||(t[44]=(0,s.eW)(" 체크아웃 날짜: ")),(0,s.bo)((0,s.Lk)("input",{type:"date","onUpdate:modelValue":t[12]||(t[12]=e=>r.editingReservation.checkOut=e)},null,512),[[n.Jo,r.editingReservation.checkOut]])]),(0,s.Lk)("label",null,[t[45]||(t[45]=(0,s.eW)(" 요청 사항: ")),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[13]||(t[13]=e=>r.editingReservation.request=e)},null,512),[[n.Jo,r.editingReservation.request]])]),t[46]||(t[46]=(0,s.Lk)("button",{type:"submit",class:"save-button"},"저장",-1)),(0,s.Lk)("button",{type:"button",class:"cancel-button",onClick:t[14]||(t[14]=e=>l.cancelEdit("reservation"))},"취소")],32)])])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),"Analytics"===r.currentView?((0,s.uX)(),(0,s.CE)("div",Oa,t[50]||(t[50]=[(0,s.Lk)("h2",null,"호텔 분석",-1),(0,s.Lk)("p",null,"호텔 관련 데이터를 분석합니다.",-1)]))):(0,s.Q3)("",!0)])])),_:1})}var qa=a(3083),Ha={name:"HotelAdminPage",components:{SidebarLayout:qa.A},data(){return{currentView:"Dashboard",roomSummary:null,reservationSummary:[],rooms:[],editingRoom:null,reservations:[],editingReservation:null,hotelId:null}},methods:{async fetchHotelId(){try{const e=await U.A.get("http://43.200.45.122/api/manager-hotel-id",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.hotelId=e.data,console.log("받아온 호텔 ID:",this.hotelId),this.fetchRoomSummary(),this.fetchRooms(),this.fetchReservations()}catch(e){console.error("호텔 ID를 가져오는 중 오류 발생:",e),alert("호텔 ID를 가져오지 못했습니다. 다시 로그인해주세요.")}},async fetchRoomSummary(){try{if(!this.hotelId)return void console.error("호텔 ID가 설정되지 않았습니다.");const e=await U.A.get(`http://43.200.45.122/api/rooms/hotel/${this.hotelId}/room-summary`);this.roomSummary=e.data}catch(e){console.error("객실 요약 정보를 가져오는 중 오류 발생:",e),this.roomSummary={totalRooms:0,roomTypeCounts:{}}}},async fetchReservationSummary(){try{const e=await U.A.get("http://43.200.45.122/api/auth/reservation-summary",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.reservationSummary=e.data}catch(e){console.error("예약 요약 정보를 가져오는 중 오류 발생:",e),this.reservationSummary=[]}},async fetchRooms(){try{if(!this.hotelId)return void console.error("호텔 ID가 설정되지 않았습니다.");const e=await U.A.get(`http://43.200.45.122/api/rooms/hotel/${this.hotelId}`);this.rooms=e.data}catch(e){console.error("객실 정보를 가져오는 중 오류 발생:",e),this.rooms=[]}},openEditModal(e){this.editingRoom={...e}},editRoom(e){this.editingRoom={...e,amenities:e.amenities||""}},async saveEdit(){if(this.editingRoom.name&&this.editingRoom.occupancy&&this.editingRoom.price)try{await U.A.put(`http://43.200.45.122/api/rooms/${this.editingRoom.roomId}`,this.editingRoom),alert("객실 정보가 성공적으로 수정되었습니다!"),this.fetchRooms(),this.editingRoom=null}catch(e){console.error("수정 중 오류 발생:",e),alert("수정에 실패했습니다. 다시 시도해주세요.")}else alert("모든 필드를 입력해주세요.")},getAmenities(e){const t=[];return e.bathFacility&&t.push("욕실"),e.bath&&t.push("욕조"),e.airCondition&&t.push("에어컨"),e.tv&&t.push("TV"),e.cable&&t.push("케이블 TV"),e.internet&&t.push("인터넷"),e.refrigerator&&t.push("냉장고"),e.toiletries&&t.push("세면도구"),e.sofa&&t.push("소파"),e.tableYn&&t.push("테이블"),e.hairdryer&&t.push("헤어드라이어"),t.length>0?t:["편의시설 없음"]},getLimitedAmenities(e){return e.amenitiesExpanded?this.getAmenities(e):this.getAmenities(e).slice(0,3)},toggleAmenities(e){e.amenitiesExpanded=!e.amenitiesExpanded},async updateRoom(){try{const e={...this.editingRoom,amenities:(this.editingRoom.amenities||"").split(",").map((e=>e.trim()))};await U.A.put(`http://43.200.45.122/api/rooms/${e.roomId}`,e),alert("객실 정보가 수정되었습니다."),this.editingRoom=null,this.fetchRooms()}catch(e){console.error("객실 정보를 수정하는 중 오류 발생:",e),alert("객실 정보를 수정하지 못했습니다.")}},async fetchReservations(){try{if(!this.hotelId)return void console.error("호텔 ID가 설정되지 않았습니다.");const e=await U.A.get(`http://43.200.45.122/api/auth/reservation-summary?hotelId=${this.hotelId}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});this.reservationSummary=e.data}catch(e){console.error("예약 요약 정보를 가져오는 중 오류 발생:",e),this.reservationSummary=[]}},async fetchAllReservations(){try{const e=await U.A.get("http://43.200.45.122/api/auth/all-reservations",{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log("Reservations Response:",e.data),Array.isArray(e.data)&&e.data.length>0?this.reservations=e.data:(console.warn("예약 데이터가 없습니다."),this.reservations=[])}catch(e){console.error("전체 예약 정보를 가져오는 중 오류 발생:",e.response||e),this.reservations=[]}},async updateReservation(){if(this.editingReservation)if(new Date(this.editingReservation.checkIn)>=new Date(this.editingReservation.checkOut))alert("체크인 날짜는 체크아웃 날짜보다 이전이어야 합니다.");else try{const e={status:this.editingReservation.status,checkIn:this.editingReservation.checkIn,checkOut:this.editingReservation.checkOut,request:this.editingReservation.request},t=await U.A.put(`http://43.200.45.122/api/auth/reservation/${this.editingReservation.reservationId}`,e,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});console.log("예약 수정 응답:",t.data),alert("예약 정보가 성공적으로 수정되었습니다!"),this.editingReservation=null,this.fetchAllReservations()}catch(e){console.error("예약 수정 요청 실패:",e),alert("예약 수정 중 오류가 발생했습니다.")}else alert("수정할 예약을 선택하세요.")},openEditReservation(e){this.editingReservation={...e}},cancelEdit(e){"reservation"===e?this.editingReservation=null:"room"===e&&(this.editingRoom=null)}},mounted(){this.fetchHotelId(),this.fetchAllReservations()}};const xa=(0,T.A)(Ha,[["render",Fa],["__scopeId","data-v-c3683650"]]);var Qa=xa;const Ka={class:"search-page"},Ba={class:"search-container"},Ja={class:"search-bar"},Wa={key:0,class:"autocomplete-list"},ja=["onClick"],za={class:"hotel-name"},Ga={class:"hotel-address"},Ya={key:0,class:"no-results"},Za={class:"date-picker"},eo=["min"],to=["min"],ao={key:1,class:"warning-message"},oo={class:"occupancy-selector"},so=["value"],no={class:"map-button-container"},io={class:"results"},ro={key:0},lo=["onClick"],co=["src"],uo={class:"hotel-info"};function ho(e,t,a,o,r,l){return(0,s.uX)(),(0,s.CE)("div",Ka,[(0,s.Lk)("div",Ba,[(0,s.Lk)("div",Ja,[t[7]||(t[7]=(0,s.Lk)("span",{class:"icon"},"🔍",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchQuery=e),type:"text",placeholder:"지역, 숙소명 키워드로 찾아보세요",onKeyup:t[1]||(t[1]=(0,n.jR)(((...e)=>l.performSearch&&l.performSearch(...e)),["enter"]))},null,544),[[n.Jo,r.searchQuery]])]),r.autocompleteResults.length>0?((0,s.uX)(),(0,s.CE)("ul",Wa,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.autocompleteResults,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.hotelId,onClick:t=>l.selectAutocompleteResult(e),class:"autocomplete-item"},[(0,s.Lk)("span",za,(0,i.v_)(e.name),1),(0,s.Lk)("span",Ga,(0,i.v_)(e.address||"주소 정보 없음"),1)],8,ja)))),128)),r.noResults?((0,s.uX)(),(0,s.CE)("li",Ya,"연관된 검색어가 없습니다.")):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),(0,s.Lk)("div",Za,[t[8]||(t[8]=(0,s.Lk)("span",{class:"icon"},"📅",-1)),(0,s.bo)((0,s.Lk)("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=e=>r.checkInDate=e),min:r.today,placeholder:"체크인",onChange:t[3]||(t[3]=(...e)=>l.validateCheckInDate&&l.validateCheckInDate(...e))},null,40,eo),[[n.Jo,r.checkInDate]]),t[9]||(t[9]=(0,s.Lk)("span",null,"~",-1)),(0,s.bo)((0,s.Lk)("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=e=>r.checkOutDate=e),min:r.checkInDate||r.today,placeholder:"체크아웃"},null,8,to),[[n.Jo,r.checkOutDate]])]),r.dateWarning?((0,s.uX)(),(0,s.CE)("div",ao,(0,i.v_)(r.dateWarning),1)):(0,s.Q3)("",!0),(0,s.Lk)("div",oo,[t[11]||(t[11]=(0,s.Lk)("span",{class:"icon"},"👤",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>r.totalGuests=e)},[t[10]||(t[10]=(0,s.Lk)("option",{value:"0"},"인원무관",-1)),((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(20,(e=>(0,s.Lk)("option",{key:e,value:e},(0,i.v_)(e)+"명",9,so))),64))],512),[[n.u1,r.totalGuests]])])]),(0,s.Lk)("div",no,[(0,s.Lk)("button",{class:"map-button",onClick:t[6]||(t[6]=(...e)=>l.goToMapView&&l.goToMapView(...e))},"지도 보기")]),(0,s.Lk)("div",io,[0===r.hotels.length?((0,s.uX)(),(0,s.CE)("div",ro)):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.hotels,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.hotelId,class:"hotel-item",onClick:t=>l.goToHotelDetail(e.hotelId)},[(0,s.Lk)("img",{src:e.imageUrl||r.defaultImage,alt:"Hotel Image",class:"hotel-image"},null,8,co),(0,s.Lk)("div",uo,[(0,s.Lk)("h3",null,(0,i.v_)(e.name),1),(0,s.Lk)("p",null,(0,i.v_)(e.address||"주소 정보 없음"),1),(0,s.Lk)("p",null,"평점: "+(0,i.v_)(e.rating||"정보 없음"),1)])],8,lo)))),128))])])}var mo={name:"SearchPage",data(){return{searchQuery:this.$route.query.query||"",hotels:[],checkInDate:"",checkOutDate:"",totalGuests:0,today:(new Date).toISOString().split("T")[0],defaultImage:"https://png.pngtree.com/png-vector/20240613/ourlarge/pngtree-modern-hotel-icon-with-palm-trees-black-isolated-on-white-background-vector-png-image_7010310.png",autocompleteResults:[],noResults:!1,dateWarning:""}},created(){this.searchQuery&&this.performSearch()},methods:{async performSearch(){const e={query:this.searchQuery||void 0,checkInDate:this.checkInDate||void 0,checkOutDate:this.checkOutDate||void 0,guests:this.totalGuests||1};try{const t=await U.A.get("/api/hotels/search-by-date-and-guest",{params:e});this.hotels=t.data,this.$router.replace({query:{...this.$route.query,query:this.searchQuery}}),this.autocompleteResults=[],this.noResults=!1}catch(t){console.error("검색 결과를 가져오는 중 오류 발생:",t),this.hotels=[]}},async fetchAutocompleteResults(){if(this.searchQuery.length>0){const t=this.searchQuery.replace(/\s+/g,"");try{const e=await U.A.get(`/api/hotels/search?query=${t}`);this.autocompleteResults=e.data,this.noResults=0===this.autocompleteResults.length}catch(e){console.error("자동 완성 결과를 가져오는 중 오류 발생:",e),this.autocompleteResults=[],this.noResults=!0}}else this.autocompleteResults=[],this.noResults=!1},validateCheckInDate(){this.checkInDate<this.today?(this.dateWarning="체크인 날짜는 오늘 이후로 선택해주세요.",this.checkInDate=""):this.dateWarning=""},updateCheckoutMinDate(){this.checkInDate&&this.checkInDate<this.today&&(this.checkInDate=this.today)},goToHotelDetail(e){this.$router.push(`/hotel-details/${e}`)},goToMapView(){this.$router.push({path:"/map-view",query:{hotels:JSON.stringify(this.hotels),query:this.searchQuery}})},selectAutocompleteResult(e){this.searchQuery=e.name,this.performSearch()}},watch:{searchQuery(){this.fetchAutocompleteResults()}}};const po=(0,T.A)(mo,[["render",ho],["__scopeId","data-v-4bb058a2"]]);var vo=po;const ko={class:"map-page"};function go(e,t,a,o,n,i){return(0,s.uX)(),(0,s.CE)("div",ko,[t[1]||(t[1]=(0,s.Lk)("h2",null,"지도",-1)),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.goToSearchPage&&i.goToSearchPage(...e)),class:"back-button"},"검색 페이지로 돌아가기"),t[2]||(t[2]=(0,s.Lk)("div",{id:"map"},null,-1))])}var fo={name:"MapPage",props:{hotels:{type:Array,required:!1,default:()=>[]},location:{type:String,required:!1}},data(){return{mapHotels:[]}},async mounted(){this.hotels.length>0?this.mapHotels=this.hotels:await this.fetchHotels(),this.loadKakaoMap()},beforeUnmount(){const e=document.querySelector("script[src*='//dapi.kakao.com/v2/maps/sdk.js']");e&&(e.remove(),delete window.kakao)},methods:{async fetchHotels(){try{const e=await U.A.get(`/api/hotels/search?location=${this.location||""}`);console.log("API response:",e.data),this.mapHotels=Array.isArray(e.data)?e.data:[],console.log("mapHotels:",this.mapHotels)}catch(e){console.error("호텔 목록을 가져오는 중 오류 발생:",e),this.mapHotels=[]}},loadKakaoMap(){if("undefined"===typeof kakao){const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?appkey=8e08ae88fe732a2c4cfd5d4e46ee2fe5&autoload=false",e.onload=this.initMap,document.head.appendChild(e)}else this.initMap()},initMap(){kakao.maps.load((()=>{const e=document.getElementById("map"),t={center:new kakao.maps.LatLng(37.5665,126.978),level:5},a=new kakao.maps.Map(e,t),o=new kakao.maps.LatLngBounds,s="https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";Array.isArray(this.mapHotels)&&this.mapHotels.length>0?(this.mapHotels.forEach((e=>{if(e.mapY&&e.mapX){const t=new kakao.maps.LatLng(e.mapY,e.mapX),n=new kakao.maps.Size(24,35),i=new kakao.maps.MarkerImage(s,n),r=new kakao.maps.Marker({map:a,position:t,title:e.name,image:i});o.extend(t);const l=`\n                  <div style="\n                      width: 200px; \n                      padding: 10px; \n                      font-family: Arial, sans-serif; \n                      color: #333;\n                      border-radius: 8px;\n                  ">\n                      <img src="${e.imageUrl}" \n                          alt="${e.name}" \n                          style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 8px;" />\n                      <strong style="display: block; font-size: 16px; font-weight: bold; color: #333; margin-bottom: 5px;">\n                      ${e.name}\n                      </strong>\n                      <span style="font-size: 14px; color: #666; line-height: 1.5;">\n                      ${e.address}\n                      </span>\n                  </div>\n                  `,c=new kakao.maps.InfoWindow({content:l,removable:!1});kakao.maps.event.addListener(r,"mouseover",(()=>{c.open(a,r)})),kakao.maps.event.addListener(r,"mouseout",(()=>{c.close()})),kakao.maps.event.addListener(r,"click",(()=>{this.$router.push(`/hotel-details/${e.hotelId}`)}))}})),a.setBounds(o)):console.warn("mapHotels 배열이 비어 있습니다.")}))},goToSearchPage(){this.$router.push({path:"/search-results",query:{query:this.$route.query.query}})}}};const yo=(0,T.A)(fo,[["render",go],["__scopeId","data-v-7a20a530"]]);var Lo=yo;const bo={class:"container"},wo={class:"login-form"},Io={class:"input-group"},Co={class:"input-group"};function Ro(e,t,a,o,i,r){return(0,s.uX)(),(0,s.CE)("div",bo,[(0,s.Lk)("div",wo,[t[6]||(t[6]=(0,s.Lk)("h2",{class:"title"},"ADMIN",-1)),(0,s.Lk)("form",{onSubmit:t[2]||(t[2]=(0,n.D$)(((...e)=>r.submitForm&&r.submitForm(...e)),["prevent"]))},[(0,s.Lk)("div",Io,[t[3]||(t[3]=(0,s.Lk)("label",{for:"email"},"Email",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>i.email=e)},null,512),[[n.Jo,i.email]])]),(0,s.Lk)("div",Co,[t[4]||(t[4]=(0,s.Lk)("label",{for:"password"},"비밀번호",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password",id:"passwd","onUpdate:modelValue":t[1]||(t[1]=e=>i.passwd=e)},null,512),[[n.Jo,i.passwd]])]),t[5]||(t[5]=(0,s.Lk)("div",{class:"top-actions"},[(0,s.Lk)("button",{type:"submit",class:"login-button"},"로그인")],-1))],32)])])}var Eo={name:"LoginForm",data(){return{email:"",passwd:""}},methods:{async submitForm(){const e={email:this.email,passwd:this.passwd};try{const t=(0,B.n)();await t.login(e),alert("로그인 성공!"),Uo.push({path:"/admin/hotel"})}catch(t){console.error("로그인 중 오류 발생: ",t),alert("로그인 실패. 이메일과 비밀번호를 확인하세요.")}}}};const _o=(0,T.A)(Eo,[["render",Ro],["__scopeId","data-v-70e32474"]]);var Ao=_o,So=a(5068);const Xo=[{path:"/",component:V},{path:"/my_page",component:Ke,children:[{path:"",component:Et},{path:"reservations",component:jt},{path:"edit-info",component:da}]},{path:"/register",component:z},{path:"/login",component:ie},{path:"/hotel-details/:id",component:()=>a.e(925).then(a.bind(a,2925))},{path:"/room-details/:roomId",component:()=>a.e(731).then(a.bind(a,4731)),name:"HotelRoom"},{path:"/oauth2/success",component:ue},{path:"/find-my-id",component:()=>a.e(594).then(a.bind(a,5594))},{path:"/payment",component:()=>a.e(195).then(a.bind(a,1195)),name:"paymentPage"},{path:"/verify-email",component:ye},{path:"/admin/:any*",component:Ao},{path:"/admin/hotel",component:Qa,meta:{requiresAuth:!0,requiredRole:"ROLE_HOTELADMIN"}},{path:"/admin/system",component:()=>a.e(176).then(a.bind(a,9176)),meta:{requiresAuth:!0,requiredRole:"ROLE_ADMIN"}},{path:"/reset-password",component:Se},{path:"/search-results",component:vo},{path:"/map-view",component:Lo,props:e=>({hotels:e.query.hotels?JSON.parse(e.query.hotels):[]})}],Po=(0,o.aE)({history:(0,o.LA)(),routes:Xo,scrollBehavior(){return{top:0}}});Po.beforeEach(((e,t,a)=>{const o=sessionStorage.getItem("token");let s=null;if(o)try{const e=(0,So.s)(o);s=e.role}catch(n){return console.error("토큰 디코딩 중 오류 발생: ",n),a({path:"/"})}return"/admin"===e.path?o?a("ROLE_ADMIN"===s?{path:"/admin/system"}:"ROLE_HOTELADMIN"===s?{path:"/admin/hotel"}:{path:"/"}):a():"/admin/hotel"!==e.path&&!e.path.startsWith("/my_page")||"ROLE_ADMIN"!==s?"/admin/system"!==e.path&&!e.path.startsWith("/my_page")||"ROLE_HOTELADMIN"!==s?!e.meta.requiresAuth||o&&e.meta.requiredRole===s?void a():a({path:"/admin"}):a({path:"/admin/hotel"}):a({path:"/admin/system"})}));var Uo=Po},6698:function(e,t,a){a.d(t,{n:function(){return i}});a(4114);var o=a(5234),s=a(412),n=a(7360);const i=(0,o.nY)("auth",{state:()=>({currentUser:null,accessToken:null,LoggedIn:!1,emailMessage:"",isEmailAvailable:!1,isVerified:!1,verificationToken:null,userId:null,userName:null,phone:null}),actions:{async signup(e){try{if(!this.verificationToken)throw new Error("이메일 인증 토큰이 없습니다.");const t=await(0,s.E_)(e,this.verificationToken);return t}catch(t){throw console.error(t),t}},async sendVerificationEmail(e,t){try{const a=await(0,s.E7)(e,t);return this.isVerified=!0,this.verificationToken=a.data,localStorage.setItem("verificationToken",a.data),a}catch(a){throw console.error("이메일 인증 메일 발송 실패:",a),this.isVerified=!1,a}},async verifyEmailToken(e){try{const t=await(0,s.vb)(e);return t&&200===t.status&&(this.isVerified=!0,this.verificationToken=e),t}catch(t){throw console.error("이메일 인증 실패:",t),this.isVerified=!1,t}},async checkEmailAvailability(e){try{const t=await(0,s.Ro)(e);this.emailMessage=t.data,this.isEmailAvailable=!0}catch(t){t.response&&409===t.response.status?this.emailMessage=t.response.data:this.emailMessage="이메일 중복 확인 중 오류가 발생했습니다.",this.isEmailAvailable=!1}},async login(e){try{const t=await(0,s.Lx)(e);this.currentUser=t.data.email,this.LoggedIn=!0,this.setAccessToken(t.data.token),this.phone=t.data.phone,this.userName=t.data.userName,this.userId=t.data.userId,console.log("로그인 성공:",t.data),localStorage.setItem("userInfo",JSON.stringify({userName:t.data.userName,userId:t.data.userId,email:t.data.email,phone:t.data.phone})),sessionStorage.setItem("token",t.data.token)}catch(t){throw console.error("로그인 실패:",t),new Error("로그인 실패")}},setAccessToken(e){this.accessToken=e,this.LoggedIn=!!e,sessionStorage.setItem("token",e)},logout(){this.currentUser=null,this.accessToken=null,this.LoggedIn=!1,this.userId=null,this.userName=null,this.phone=null,sessionStorage.removeItem("token"),localStorage.removeItem("userInfo"),localStorage.removeItem("verificationToken"),localStorage.removeItem("verifiedEmail"),n.A.push({path:"/"}),console.log("로그아웃 성공")},checkLoginStatus(){const e=sessionStorage.getItem("token"),t=localStorage.getItem("userInfo");if(e){if(this.accessToken=e,this.LoggedIn=!0,t){const e=JSON.parse(t);this.userName=e.userName,this.userId=e.userId,this.currentUser=e.email,this.phone=e.phone}}else this.LoggedIn=!1},async updateUserInfo(e){try{const t=await(0,s.J)(e,this.accessToken);return 200===t.status&&(localStorage.setItem("userInfo",JSON.stringify({...JSON.parse(localStorage.getItem("userInfo")),...e})),this.userName=e.userName,this.phone=e.phone,console.log("회원 정보 수정 성공:",t.data)),t}catch(t){throw console.error("회원 정보 수정 오류:",t),t}},async verifyPassword(e){try{const t=await(0,s.PY)(e,this.accessToken);return t}catch(t){throw console.error("비밀번호 확인 오류:",t),t}},async changePassword(e){try{const t=this.currentUser,a=localStorage.getItem("verificationToken"),o=await(0,s.UR)(t,e,a);return o}catch(t){throw console.error("비밀번호 변경 오류:",t),t}},async deactivateUser(){try{const e=await(0,s.od)(this.accessToken);return e}catch(e){throw console.error("계정 탈퇴 오류:",e),e}},async getUserInfo(){try{const e=this.accessToken;if(!e)throw new Error("로그인이 필요합니다.");const t=await(0,s.ug)(e);return t}catch(e){throw console.error("사용자 정보 가져오기 오류:",e),e}}}})},7367:function(e,t,a){a.d(t,{A:function(){return m}});var o=a(6768),s=a(4232);const n={key:0,class:"modal"},i={class:"modal-content"},r={key:0,class:"review-images"},l=["src"];function c(e,t,a,c,u,d){return a.isOpen?((0,o.uX)(),(0,o.CE)("div",n,[(0,o.Lk)("div",i,[t[1]||(t[1]=(0,o.Lk)("h2",null,"리뷰 내용",-1)),(0,o.Lk)("p",null,(0,s.v_)(a.review.content),1),a.review.imageUrl&&a.review.imageUrl.length>0?((0,o.uX)(),(0,o.CE)("div",r,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.review.imageUrl,((e,t)=>((0,o.uX)(),(0,o.CE)("img",{src:e,key:t,class:"review-image"},null,8,l)))),128))])):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>d.closeModal&&d.closeModal(...e))},"닫기")])])):(0,o.Q3)("",!0)}var u={props:{isOpen:{type:Boolean,required:!0},review:{type:Object,required:!0}},methods:{closeModal(){this.$emit("close")}}},d=a(1241);const h=(0,d.A)(u,[["render",c],["__scopeId","data-v-6175b26a"]]);var m=h},3083:function(e,t,a){a.d(t,{A:function(){return h}});var o=a(6768),s=a(4232);const n={class:"layout-container"},i={key:0,class:"sidebar"},r={class:"main-content"};function l(e,t,a,l,c,u){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",n,[a.showSidebar?((0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("h2",null,(0,s.v_)(a.title),1),(0,o.RG)(e.$slots,"menu",{},void 0,!0)])):(0,o.Q3)("",!0),(0,o.Lk)("div",r,[(0,o.RG)(e.$slots,"default",{},void 0,!0)])])])}var c={props:{showSidebar:{type:Boolean,default:!0},title:{type:String,default:"관리자"}}},u=a(1241);const d=(0,u.A)(c,[["render",l],["__scopeId","data-v-5d45674b"]]);var h=d}},t={};function a(o){var s=t[o];if(void 0!==s)return s.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(t,o,s,n){if(!o){var i=1/0;for(u=0;u<e.length;u++){o=e[u][0],s=e[u][1],n=e[u][2];for(var r=!0,l=0;l<o.length;l++)(!1&n||i>=n)&&Object.keys(a.O).every((function(e){return a.O[e](o[l])}))?o.splice(l--,1):(r=!1,n<i&&(i=n));if(r){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[o,s,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,o){return a.f[o](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+e+"."+{176:"60a568be",195:"e03696af",594:"9f83eb60",731:"d7f912e1",925:"bef7a7d1"}[e]+".js"}}(),function(){a.miniCssF=function(e){return"css/"+e+"."+{176:"97631f8c",195:"2a82a40e",594:"d12f0966",731:"18d3b13c",925:"11207204"}[e]+".css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="frontend:";a.l=function(o,s,n,i){if(e[o])e[o].push(s);else{var r,l;if(void 0!==n)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+n){r=d;break}}r||(l=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,a.nc&&r.setAttribute("nonce",a.nc),r.setAttribute("data-webpack",t+n),r.src=o),e[o]=[s];var h=function(t,a){r.onerror=r.onload=null,clearTimeout(m);var s=e[o];if(delete e[o],r.parentNode&&r.parentNode.removeChild(r),s&&s.forEach((function(e){return e(a)})),t)return t(a)},m=setTimeout(h.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=h.bind(null,r.onerror),r.onload=h.bind(null,r.onload),l&&document.head.appendChild(r)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,o,s,n){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",a.nc&&(i.nonce=a.nc);var r=function(a){if(i.onerror=i.onload=null,"load"===a.type)s();else{var o=a&&a.type,r=a&&a.target&&a.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+o+": "+r+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=o,l.request=r,i.parentNode&&i.parentNode.removeChild(i),n(l)}};return i.onerror=i.onload=r,i.href=t,o?o.parentNode.insertBefore(i,o.nextSibling):document.head.appendChild(i),i},t=function(e,t){for(var a=document.getElementsByTagName("link"),o=0;o<a.length;o++){var s=a[o],n=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(n===e||n===t))return s}var i=document.getElementsByTagName("style");for(o=0;o<i.length;o++){s=i[o],n=s.getAttribute("data-href");if(n===e||n===t)return s}},o=function(o){return new Promise((function(s,n){var i=a.miniCssF(o),r=a.p+i;if(t(i,r))return s();e(o,r,null,s,n)}))},s={524:0};a.f.miniCss=function(e,t){var a={176:1,195:1,594:1,731:1,925:1};s[e]?t.push(s[e]):0!==s[e]&&a[e]&&t.push(s[e]=o(e).then((function(){s[e]=0}),(function(t){throw delete s[e],t})))}}}(),function(){var e={524:0};a.f.j=function(t,o){var s=a.o(e,t)?e[t]:void 0;if(0!==s)if(s)o.push(s[2]);else{var n=new Promise((function(a,o){s=e[t]=[a,o]}));o.push(s[2]=n);var i=a.p+a.u(t),r=new Error,l=function(o){if(a.o(e,t)&&(s=e[t],0!==s&&(e[t]=void 0),s)){var n=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.src;r.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",r.name="ChunkLoadError",r.type=n,r.request=i,s[1](r)}};a.l(i,l,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,n,i=o[0],r=o[1],l=o[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(s in r)a.o(r,s)&&(a.m[s]=r[s]);if(l)var u=l(a)}for(t&&t(o);c<i.length;c++)n=i[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(u)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[504],(function(){return a(8429)}));o=a.O(o)})();
//# sourceMappingURL=app.229021ca.js.map