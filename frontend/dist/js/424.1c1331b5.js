"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[424],{424:function(e,t,o){o.r(t),o.d(t,{default:function(){return ie}});var s=o(6768),a=o(4232),i=o(5130);const r={key:0,class:"details-container"},l={class:"img-container"},n=["src"],c={key:1,class:"no-image-container"},d={class:"hotel-info-card"},h={class:"hotel-top"},v={class:"hotel-name"},k={key:0,class:"favorite-container"},u={key:0,class:"fas fa-heart"},m={key:1,class:"far fa-heart"},p={class:"hotel-info"},g={class:"rating"},L={class:"hotel-info-details"},w={class:"review-container"},C={key:0},y={key:1},f={class:"review-top"},I={class:"review-rating"},b={class:"review-actions"},X={class:"review-date"},E=["onClick"],R=["onClick"],F={class:"reviewer"},_={class:"review-content"},M={key:0,class:"review-images"},x=["src","onClick"],H={key:0,class:"load-more-container"},T={class:"room-list"},$={key:0},A={class:"room-image-container"},D=["src"],U={key:1,class:"no-room-image"},K={class:"room-info"},O={class:"room-name"},S={class:"avg-person"},P={class:"avg-person-text"},Q={class:"reservation-info"},W={class:"check-info"},Y=["innerHTML"],j=["innerHTML"],B={class:"price"},N={class:"reservation-bottom"},q={class:"room-count"},z=["onClick"],G={key:1},J={key:1};function V(e,t,o,V,Z,ee){return Z.hotel?((0,s.uX)(),(0,s.CE)("div",r,[(0,s.Lk)("div",l,[Z.hotel.imageUrl?((0,s.uX)(),(0,s.CE)("img",{key:0,src:Z.hotel.imageUrl,alt:"Hotel Image"},null,8,n)):((0,s.uX)(),(0,s.CE)("div",c,t[3]||(t[3]=[(0,s.Lk)("p",{class:"no-image-text"},"업체측에서 제공된 이미지가 없습니다",-1)])))]),(0,s.Lk)("div",d,[(0,s.Lk)("div",h,[(0,s.Lk)("div",null,[(0,s.Lk)("div",v,(0,a.v_)(Z.hotel.name),1)]),Z.isLoggedIn?((0,s.uX)(),(0,s.CE)("div",k,[(0,s.Lk)("div",{class:(0,a.C4)(["heart-button",{favorited:Z.isFavorited,unfavorited:!Z.isFavorited}]),onClick:t[0]||(t[0]=(...e)=>ee.toggleFavorite&&ee.toggleFavorite(...e))},[Z.isFavorited?((0,s.uX)(),(0,s.CE)("i",u)):((0,s.uX)(),(0,s.CE)("i",m))],2)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",p,[(0,s.Lk)("span",g,"⭐ "+(0,a.v_)(Z.hotel.rating||"4.5"),1),(0,s.Lk)("span",null,"("+(0,a.v_)(Z.hotel.reviewCount||0)+" 리뷰)",1)]),(0,s.Lk)("div",L,[(0,s.Lk)("p",null,[t[4]||(t[4]=(0,s.Lk)("span",{class:"phone-icon"},"📞",-1)),(0,s.eW)(" 전화번호 : "+(0,a.v_)(Z.hotel.hotelnum||"업체측에서 제공된 정보가 없습니다."),1)]),(0,s.Lk)("p",null,[t[5]||(t[5]=(0,s.Lk)("span",{class:"location-icon"},"📍",-1)),(0,s.eW)(" "+(0,a.v_)(Z.hotel.address||"업체측에서 제공된 정보가 없습니다.")+" ",1),(0,s.Lk)("button",{class:"copy-button",onClick:t[1]||(t[1]=(...e)=>ee.copyAddressToClipboard&&ee.copyAddressToClipboard(...e))},"주소복사")]),t[6]||(t[6]=(0,s.Lk)("div",{id:"map",style:{width:"500px",height:"400px"}},null,-1))])]),(0,s.Lk)("div",w,[t[8]||(t[8]=(0,s.Lk)("h3",null,"리뷰",-1)),Z.hotelReviews&&0===Z.hotelReviews.length?((0,s.uX)(),(0,s.CE)("div",C,t[7]||(t[7]=[(0,s.Lk)("p",null,"이 호텔에 대한 리뷰가 없습니다.",-1)]))):((0,s.uX)(),(0,s.CE)("div",y,[(0,s.bF)(i.F,{name:"fade",tag:"div",class:"review-list"},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Z.visibleReviews,((t,o)=>((0,s.uX)(),(0,s.CE)("div",{key:o,class:"review-grid"},[(0,s.Lk)("div",f,[(0,s.Lk)("div",I,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(5,(e=>(0,s.Lk)("span",{key:e,class:(0,a.C4)(["star",{filled:e<=t.rating}])}," ⭐ ",2))),64))]),(0,s.Lk)("div",b,[(0,s.Lk)("div",X,(0,a.v_)(ee.reviewFormatDate(t.updateDate||t.writeDate)),1),t.userId===e.loggedInUserId?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"edit-button",onClick:o=>e.openEditModal(t)}," 수정하기 ",8,E)):((0,s.uX)(),(0,s.CE)("button",{key:1,class:"report-button",onClick:e=>ee.reportReviews(t.reviewId,t.userId)}," 신고하기 ",8,R))])]),(0,s.Lk)("div",F,(0,a.v_)(t.userName),1),(0,s.Lk)("div",_,(0,a.v_)(t.content),1),t.imageUrl&&t.imageUrl.length>0?((0,s.uX)(),(0,s.CE)("div",M,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.imageUrl,((t,o)=>((0,s.uX)(),(0,s.CE)("img",{src:t,key:o,class:"review-image",onClick:o=>e.openLightbox(t)},null,8,x)))),128))])):(0,s.Q3)("",!0)])))),128))])),_:1}),Z.visibleReviewCount<Z.hotelReviews.length?((0,s.uX)(),(0,s.CE)("div",H,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>ee.expandReviews&&ee.expandReviews(...e)),class:"load-more-btn"}," ➕ 더 보기 ")])):(0,s.Q3)("",!0)]))]),(0,s.Lk)("div",T,[t[15]||(t[15]=(0,s.Lk)("h3",null,"객실 정보",-1)),Z.hotel.rooms&&Z.hotel.rooms.length>0?((0,s.uX)(),(0,s.CE)("div",$,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Z.hotel.rooms,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.roomId,class:"room-card"},[(0,s.Lk)("div",A,[e.roomImageUrl?((0,s.uX)(),(0,s.CE)("img",{key:0,src:e.roomImageUrl,class:"room-img",alt:"Room Image"},null,8,D)):((0,s.uX)(),(0,s.CE)("div",U,t[9]||(t[9]=[(0,s.Lk)("p",{class:"no-room-image-text"},"업체측에서 제공된 이미지가 없습니다",-1)])))]),(0,s.Lk)("div",K,[(0,s.Lk)("h4",O,(0,a.v_)(e.roomType),1),(0,s.Lk)("div",S,[t[10]||(t[10]=(0,s.Lk)("img",{class:"person-icon",src:"https://yaimg.yanolja.com/stay/static/images/v3/icon_my.png"},null,-1)),(0,s.Lk)("span",P,"기준인원 "+(0,a.v_)(e.roomOccupancy)+"인",1)]),(0,s.Lk)("div",Q,[t[13]||(t[13]=(0,s.Lk)("h5",{class:"reservation-text"},"숙박",-1)),(0,s.Lk)("div",W,[t[11]||(t[11]=(0,s.eW)(" 체크인 ")),(0,s.Lk)("span",{innerHTML:ee.formattedCheckIn},null,8,Y),t[12]||(t[12]=(0,s.eW)(" ~ 체크아웃 ")),(0,s.Lk)("span",{innerHTML:ee.formattedCheckOut},null,8,j)]),(0,s.Lk)("h2",B,(0,a.v_)(e.roomPrice?`${e.roomPrice.toLocaleString()}원`:"가격 정보 없음"),1),(0,s.Lk)("div",N,[(0,s.Lk)("div",q,"남은 객실 "+(0,a.v_)(e.roomCount)+"개",1),(0,s.Lk)("button",{onClick:t=>ee.move(e),class:"reservation_btn"},"예약 및 상세보기",8,z)])])])])))),128))])):((0,s.uX)(),(0,s.CE)("div",G,t[14]||(t[14]=[(0,s.Lk)("div",{class:"room-card"},[(0,s.Lk)("div",{class:"no-room-info-container"},[(0,s.Lk)("p",{class:"no-room-info-text"},"업체측에서 제공된 객실 정보가 없습니다.")])],-1)])))])])):((0,s.uX)(),(0,s.CE)("div",J,t[16]||(t[16]=[(0,s.Lk)("p",null,"호텔 정보를 불러오는 중입니다...",-1)])))}o(4114);var Z=o(4373),ee=o(412),te=o(6698),oe={name:"HotelDetails",data(){return{hotel:null,hotelReviews:[],visibleReviews:[],visibleReviewCount:3,isFavorited:!1,isLoggedIn:!1}},mounted(){this.fetchFavoriteStatus()},async created(){const e=(0,te.n)();e.checkLoginStatus(),this.isLoggedIn=e.LoggedIn,this.token=e.accessToken,await this.fetchHotelDetails(),this.hotel&&this.hotel.mapX&&this.hotel.mapY&&this.loadKakaoMap()},beforeUnmount(){const e=document.querySelector("script[src*='//dapi.kakao.com/v2/maps/sdk.js']");e&&(e.remove(),delete window.kakao)},watch:{hotel(e){e&&e.mapX&&e.mapY&&this.loadKakaoMap()}},computed:{formattedCheckIn(){return this.hotel.checkIn?this.hotel.checkIn.replace(/<br\s*\/?>/gi,"<br>"):"정보없음"},formattedCheckOut(){return this.hotel.checkOut?this.hotel.checkOut.replace(/<br\s*\/?>/gi,"<br>"):"정보없음"}},methods:{async fetchHotelDetails(){const e=this.$route.params.id;try{const t=await Z.A.get(`http://localhost:8081/api/hotels/${e}`);this.hotel=t.data,console.log(this.hotel),await this.fetchHotelReviews(e)}catch(t){console.error("호텔 상세 정보를 가져오는 중 오류 발생:",t)}},move(e){this.$router.push({params:{roomId:e.roomId},name:"HotelRoom",state:{hotelName:this.hotel.name,roomName:e.roomType,roomPrice:e.roomPrice,checkIn:this.hotel.checkIn,checkOut:this.hotel.checkOut,roomId:e.roomId}})},copyAddressToClipboard(){this.hotel&&this.hotel.address&&navigator.clipboard.writeText(this.hotel.address).then((()=>{alert("주소가 복사되었습니다.")})).catch((e=>{console.error("주소 복사 중 오류가 발생했습니다.",e)}))},loadKakaoMap(){if("undefined"===typeof kakao){const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?appkey=&autoload=false",e.onload=this.initMap,document.head.appendChild(e)}else this.initMap()},initMap(){kakao.maps.load((()=>{const e=document.getElementById("map"),t={center:new kakao.maps.LatLng(this.hotel.mapY||"좌표❌",this.hotel.mapX||"좌표❌"),level:3},o=new kakao.maps.Map(e,t),s=new kakao.maps.LatLng(this.hotel.mapY||"좌표❌",this.hotel.mapX||"좌표❌"),a=new kakao.maps.Marker({position:s});a.setMap(o)}))},async fetchFavoriteStatus(){const e=this.token,t=this.$route.params.id;if(this.isLoggedIn)try{const o=await Z.A.get(`http://localhost:8081/api/auth/favorites/status/${t}`,{headers:{Authorization:`Bearer ${e}`}});this.isFavorited=o.data}catch(o){console.error("찜 상태 불러오기 실패",o)}},async toggleFavorite(){const e=this.token,t=this.$route.params.id;if(!this.isLoggedIn)return void alert("로그인 후 즐겨찾기를 추가할 수 있습니다.");const o=this.isFavorited?`http://localhost:8081/api/auth/favorites/cancel/${t}`:`http://localhost:8081/api/auth/favorites/${t}`;try{await Z.A.post(o,{},{headers:{Authorization:`Bearer ${e}`}}),this.isFavorited=!this.isFavorited}catch(s){console.error("찜 상태 변경 실패",s)}},async fetchHotelReviews(e){try{const t=await(0,ee.TH)(e);this.hotelReviews=t.data,this.visibleReviews=this.hotelReviews.slice(0,this.visibleReviewCount)}catch(t){console.error("호텔 리뷰 조회 중 오류 발생:",t)}},reviewFormatDate(e){const t={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(e).toLocaleDateString("ko-KR",t)},expandReviews(){const e=this.visibleReviewCount+3;this.visibleReviewCount=e,this.visibleReviews=this.hotelReviews.slice(0,e)},async reportReviews(e,t){const o=(0,te.n)(),s=sessionStorage.getItem("token");if(!this.isLoggedIn)return alert("로그인이 필요합니다"),void this.$router.push("/login");if(!e)return alert("신고 정보를 확인할 수 없습니다."),void console.error("Missing userId or reviewId");console.log("리뷰 id : ",e),console.log("리뷰 유저 : ",t);const a={reporterId:o.userId,reportedId:t,reviewId:e};try{const e=await(0,ee.DQ)(a,s);e.data&&(alert("신고되었습니다."),console.log(e.data))}catch(i){alert("신고 중 오류가 발생했습니다."),console.error("Axios request error:",i.response||i.message)}}}},se=o(1241);const ae=(0,se.A)(oe,[["render",V],["__scopeId","data-v-5d24fcb8"]]);var ie=ae}}]);
//# sourceMappingURL=424.1c1331b5.js.map